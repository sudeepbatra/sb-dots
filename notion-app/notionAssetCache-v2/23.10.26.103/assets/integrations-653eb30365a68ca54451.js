"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[801],{87886:(e,t,r)=>{r.r(t),r.d(t,{LinkPreviewLab:()=>te,default:()=>ee});var a=r(97464),i=r.n(a),n=r(77094),o=r.n(n),l=r(67294),s=r(480),d=r(16489),u=r(24405),p=r(63123),c=r(53397),g=r(89602),m=r(70203),v=r(97880),f=r(82990),h=r(44876),y=r(36054),b=r(5366),_=r(45016),x=r(43250),M=r(91996),F=r(65270),I=r(60709),w=r(27832),S=r(61766),k=r(30874),R=r(3403),Z=r(47323),C=r(52275),T=r(31945),E=r(74194),U=r(78140),P=r(32163),B=r(63296),V=r(72495),A=r(29823),L=r(97812),D=r(76745),N=r(67206),q=r(17970),z=r(34958),O=r(14577),j=r(20475),W=r(8848),H=r(77744),K=r(58032),$=r(64369);r(29551);function G(e){var t,r;const[a,i]=(0,l.useState)(!1);return o()("div",{onMouseEnter:()=>{i(!0)},onMouseLeave:()=>{i(!1)}},void 0,o()(Y,{isInverted:e.isInverted},void 0,o()(J,{showSize:null!==(t=e.showSize)&&void 0!==t?t:a,showInsets:null!==(r=e.showInsets)&&void 0!==r?r:a,insetSize:24},void 0,o()(Q,{isInverted:e.isInverted},void 0,e.children))))}function Y(e){const t=(0,u.F)(),r=X(),a=e.isInverted?r:t,i=(0,l.useMemo)((()=>({borderRadius:3,overflow:"hidden",border:`1px solid ${a.regularDividerColor}`,backgroundColor:a.contentBackground,marginTop:12,marginBottom:12,color:a.regularTextColor})),[a]);return o()("div",{style:i},void 0,e.children)}function J(e){const{showInsets:t,showSize:r,insetSize:a,children:i}=e,n=(0,l.useRef)(null),s=(0,u.y)((e=>{const r=t?"rgba(255, 105, 180, 1)":"rgba(255, 105, 180, 0)",i=`1px dashed ${r}`,n=`${a}px`,o="all 0.1s ease-in-out",l={t:{borderBottom:i,transition:o},l:{borderRight:i,transition:o},r:{borderLeft:i,transition:o},b:{borderTop:i,transition:o,position:"relative"}};return{grid:{display:"grid",gridTemplateColumns:`${n} auto ${n}`,gridTemplateRows:`${n} auto ${n}`,...l.t,...l.l,...l.r,...l.b},...l,tl:{...l.t,...l.l},tr:{...l.t,...l.r},bl:{...l.b,...l.l},br:{...l.b,...l.r},c:{position:"relative"},insetText:{color:r,fontSize:10,paddingLeft:(a-10)/2,fontFamily:f.Z.baseFontFamily.githubMono,lineHeight:n,maxHeight:a,transition:o,position:"absolute"}}}),[t,a]);return o()("div",{style:s.grid},void 0,o()("div",{style:s.tl}),o()("div",{style:s.t}),o()("div",{style:s.tr}),o()("div",{style:s.l}),l.createElement("div",{style:s.c,ref:n},i),o()(K.Z,{forceVisibleState:null!=r?r:t,renderTooltip:()=>{var e;return`${null===(e=n.current)||void 0===e?void 0:e.getBoundingClientRect().height}px`},placement:K.Z.Placement.Right,render:()=>o()("div",{style:s.r})}),o()("div",{style:s.bl}),o()(K.Z,{placement:K.Z.Placement.Bottom,forceVisibleState:null!=r?r:t,renderTooltip:()=>{var e;return`${null===(e=n.current)||void 0===e?void 0:e.getBoundingClientRect().width}px`},render:()=>o()("div",{style:s.b},void 0,o()($.Z,{style:s.insetText},void 0,`${a}px inset`))}),o()("div",{style:s.br}))}function X(){const{mode:e}=(0,u.F)();return(0,W.gh)({theme:"light"===e?"dark":"light"})}function Q(e){let{children:t,isInverted:r}=e;const{mode:a}=X(),i=function(e){const t=(0,s.O7)();return(0,l.useMemo)((()=>{const r=new j.Z;return r.setState({mode:e}),{...t,ThemeStore:r,ThemeModeStore:new O.Z((()=>r.state.mode))}}),[t,e])}(a);return r?o()(z.EnvironmentContextProvider,{value:i},void 0,t):(0,H.jD)(t)}function ee(e){const t=(0,s.O7)(),{integrationPointer:r}=e,a=(0,d.VK)((()=>w.default.state.currentUserStore),[]),i=(0,d.VK)((()=>{if(a)return a.getRecordValue(r)}),[a,r]),n=(0,p.V)({value:i,waitTimeInMs:5e3});return"pending"===n.status?o()(R.Z,{}):"rejected"===n.status||"external"!==(null==n?void 0:n.value.type)?o()(A.Z,{}):o()(L.Z,{className:x.hEP,title:o()(b.FormattedMessage,{id:"developerIntegrationLab.title.label",defaultMessage:"Link Preview Lab"}),subtitle:o()(b.FormattedMessage,{id:"developerIntegrationLab.subtitle.label",defaultMessage:"Plan out preview URL regex patterns and API responses."}),onNavigateBack:()=>(0,_.V2)(t,r),navigateBackMessage:o()(b.FormattedMessage,{id:"developerIntegrationLab.navigateBack.label",defaultMessage:"Back to integration"}),innerContainerStyles:{width:1200,margin:"auto",marginBottom:200}},void 0,o()(te,{starterIntegration:n.value}))}function te(e){let{starterIntegration:t}=e;const[r,a]=l.useState(""),[i,n]=l.useState(F.Az),[s,d]=l.useState(F.SV),[u,p]=l.useState(F.VR()),[c,g]=l.useState(F.nZ),[m,v]=l.useState(F.e_),[f,y]=l.useState(F.P4),[b,_]=l.useState(t);return l.useEffect((()=>{const{original_url_domains:e,development_url_domains:r,original_url_patterns:a}=t.info,i=(null==e?void 0:e[0])||(null==r?void 0:r[0]);if(i&&g(i),null!=a&&a[0]){const{regex:e,attributes:t}=null==a?void 0:a[0];v(e);const r=t.map(h.Ah);y(r)}}),[t]),l.useEffect((()=>{_((e=>F.Hx({domain:c,regex:m,attributes:f,currentIntegration:e})))}),[c,m,f]),l.useEffect((()=>{k.Z.setState({loaded:!0,loading:!1,spaceId:F.C,integrations:[b],externalAuthentications:[],bots:[]})}),[b]),o()("div",{style:{display:"flex",justifyContent:"space-between"}},void 0,o()(re,{style:{flex:1,marginRight:12},setErrorMessage:a,rootUrl:i,setRootUrl:n,relatedUrisToAttributes:u,setRelatedUrisToAttributes:p,domain:c,setDomain:g,regexPattern:m,setRegexPattern:v,regexAttributes:f,setRegexAttributes:y,rootAttributes:s,setRootAttributes:d}),o()(ne,{style:{flex:1},rootUrl:i,rootAttributes:s,relatedUrisToAttributes:u,integration:b,errorMessage:r}))}function re(e){const{style:t,rootUrl:r,setRootUrl:a,domain:i,setDomain:n,regexPattern:l,setRegexPattern:s,regexAttributes:u,setRegexAttributes:p,rootAttributes:c,setRootAttributes:m,relatedUrisToAttributes:v,setRelatedUrisToAttributes:h,setErrorMessage:y}=e,_=(0,d.VK)((()=>F.TG(c)),[c]);return o()("div",{style:t},void 0,o()("label",{},void 0,o()("div",{style:{fontSize:15,fontWeight:f.Z.fontWeight.medium}},void 0,o()(b.FormattedMessage,{id:"developerIntegrationLab.rootUrl.label",defaultMessage:"Pasted URL to Preview",description:"A url that the developers can test their integrations against as if a user attempted to unfurl it themselves."})),o()(E.Z,{value:r,onChange:e=>a(e.target.value)})),o()(oe,{title:o()(b.FormattedMessage,{id:"developerIntegrationLab.regexConfiguration.label",defaultMessage:"Manage Regex Configuration",description:"Allows developers to test out regular expressions to match pasted unfurled urls."}),style:{marginTop:12}},void 0,o()("label",{style:{marginTop:12}},void 0,o()("div",{style:{fontSize:15,fontWeight:f.Z.fontWeight.medium}},void 0,o()(b.FormattedMessage,{id:"developerIntegrationLab.domain.label",defaultMessage:"Domain",description:"The domain of their integration (e.g. 'notion.so')."})),o()(E.Z,{value:i,onChange:e=>n(e.target.value)})),o()(se,{regexPattern:l,setRegexPattern:s,setErrorMessage:y}),o()("label",{style:{marginTop:12}},void 0,o()("div",{style:{fontSize:15,fontWeight:f.Z.fontWeight.medium}},void 0,o()(b.FormattedMessage,{id:"developerIntegrationLab.regexAttributes.label",defaultMessage:"Regex Attributes",description:"The matched attributes within their configuredregex patterns."})),o()(le,{value:u,onChange:p,validationType:g.$1,setErrorMessage:y}))),o()(oe,{title:o()(b.FormattedMessage,{id:"developerIntegrationLab.rootAttributes.label",defaultMessage:"Unfurl response payload",description:"Allows developers to test their unfurl responses against our validator and visualizer."}),style:{marginTop:12}},void 0,o()(le,{value:c,onChange:m,validationType:g.$1,setErrorMessage:y})),o()(oe,{title:o()(b.FormattedMessage,{id:"developerIntegrationLab.relatedAttributes.label",defaultMessage:"Related unfurl response payloads",description:"Allows developers to test additional unfurl responses against our validator and visualizer."}),style:{marginTop:12}},void 0,_.map((e=>{const t=v[e];return o()(oe,{title:e,style:{marginTop:12,marginLeft:12}},e,t?o()(le,{value:t,onChange:t=>{h({...v,[e]:t})},validationType:g.$1,setErrorMessage:y}):o()(b.FormattedMessage,{id:"developerIntegrationLab.relatedAttributes.empty",defaultMessage:"No related attributes found."}))}))))}const ae=["preview","mention","hover"],ie=["authenticate","error","update","loaded"];function ne(e){const{style:t,rootUrl:r,rootAttributes:a,relatedUrisToAttributes:i,integration:n,errorMessage:s}=e,[d,u]=l.useState("preview"),[p,c]=l.useState("loaded");return o()("div",{style:t},void 0,o()("div",{style:{display:"flex",alignItems:"center"}},void 0,o()("div",{style:{marginRight:12}},void 0,"Preview type:"),o()(de,{title:d,options:ae,onSelectOption:e=>u(e)}),o()("div",{style:{marginLeft:12,marginRight:12}},void 0,"Preview state:"),o()(de,{title:p,options:ie,onSelectOption:e=>c(e)})),o()("div",{style:{marginTop:12,maxWidth:600}},void 0,o()(ue,{previewType:d,previewState:p,rootUrl:r,rootAttributes:a,relatedUrisToAttributes:i,integration:n,errorMessage:s})))}function oe(e){const[t,r]=l.useState(!1);return o()("div",{style:e.style},void 0,o()(Z.Z,{onClick:()=>r(!t),style:{display:"flex",alignItems:"center"}},void 0,c.Z.triangle({width:"0.6875em",height:"0.6875em",transition:"transform 200ms ease-out",transform:`rotateZ(${t?180:90}deg)`,marginRight:4}),e.title),t&&e.children)}function le(e){const{value:t,onChange:r,validationType:a,setErrorMessage:i}=e,[n,s]=l.useState(JSON.stringify(t,null,2));return o()(E.Z,{format:E.B.ExtraLarge,inputStyle:{fontSize:14,lineHeight:"18px",height:500},textarea:!0,value:n,onChange:e=>{const t=e.target.value;s(t);const n=M.Jv(t);if(void 0===n)i("Could not parse JSON object input.");else{const e=(0,y.Gu)(a,n);e?i(e.message):(i(""),r(n))}}})}function se(e){const{regexPattern:t,setRegexPattern:r,setErrorMessage:a}=e,[i,n]=l.useState(t);return o()("label",{style:{marginTop:12}},void 0,o()("div",{style:{fontSize:15,fontWeight:f.Z.fontWeight.medium}},void 0,"Regex Pattern"),o()(E.Z,{value:i,onChange:e=>{const t=e.target.value;n(t);try{new RegExp(t);r(t),a("")}catch(i){a("Invalid Regex.")}}}))}function de(e){const{title:t,options:r,onSelectOption:a}=e,[n,s,u]=(0,d.oR)(void 0,S.Z);return o()(T.Z,{popupType:T.Z.PopupType.Popup,buttonPopupStore:u,renderOrigin:()=>o()(B.Z,{onClick:()=>s({...n,open:!0})},void 0,t,c.Z.chevronDown({width:10,marginTop:4,marginLeft:4})),render:()=>o()(U.Z,{menuType:I.o.Popup},void 0,o()(P.Z,{type:P.i.Vertical,sections:[{key:t,items:r.map((e=>({key:e,action:()=>{a(e),s({...n,open:!1})},render:t=>l.createElement(C.Z,i()({},t,{title:e}))}))),render:e=>l.createElement(V.Z,e)}],initialFocus:void 0}))})}function ue(e){const{previewType:t,previewState:r,rootUrl:a,rootAttributes:i,relatedUrisToAttributes:n,integration:d,errorMessage:p}=e,[c,g]=l.useState(""),m=(0,s.O7)(),[v,f]=l.useState();l.useEffect((()=>{const e=F.rn({environment:m,rootUrl:a,rootAttributes:i,relatedUrisToAttributes:n,integration:d});"error"in e?g(e.error):(g(""),f(e))}),[m,a,i,n,d]),l.useEffect((()=>{g(p)}),[p]);const h=(0,u.y)((e=>({error:{marginTop:12,marginBottom:12,padding:"12px 24px",marginRight:"auto",backgroundColor:e.accentColors.red[100]}})),[]);return l.createElement(l.Fragment,null,c&&o()("div",{style:h.error},void 0,c," "),v&&l.createElement(l.Fragment,null,o()(G,{isInverted:!1,showInsets:!1,showSize:!1},void 0,o()(ce,{previewType:t,previewState:r,previewStores:v})),o()(G,{isInverted:!0,showInsets:!1,showSize:!1},void 0,o()(ce,{previewType:t,previewState:r,previewStores:v}))))}function pe(e){const{previewStores:t}=e,r=(0,u.y)((e=>({container:{borderRadius:4,boxShadow:e.lightBoxShadow}})),[]),a=(0,d.VK)((()=>{const e=t.previewBlockStore.id;if(!e)return;return{annotation:(0,m.x3)(e),store:t.inlineBlockStore,token:void 0}}),[t.previewBlockStore,t.inlineBlockStore]);return a?o()("div",{style:r.container},void 0,o()(N.D,{isHoveredTokenEditable:!0,state:a})):null}function ce(e){const{previewType:t,previewState:r,previewStores:a}=e;return"preview"===t?o()(D.Z,{store:"authenticate"===r?a.emptyInstanceBlockStore:a.previewBlockStore,disabled:!1,forceActionForUIDoc:"loaded"===r?void 0:r}):"mention"===t?o()(q.Z,{store:"authenticate"===r?a.emptyInlineBlockStore:a.inlineBlockStore,disabled:!1}):"hover"===t?l.createElement(pe,e):void(0,v.t1)(t)}},29823:(e,t,r)=>{r.d(t,{Z:()=>p});var a=r(77094),i=r.n(a),n=(r(67294),r(480)),o=r(53397),l=r(5366),s=r(45016),d=r(43250),u=r(97812);function p(){const e=(0,n.O7)();return i()(u.Z,{className:d.wG0,title:i()(l.FormattedMessage,{id:"developerIntegrationNotFound.title.label",defaultMessage:"Not Found"}),subtitle:i()(l.FormattedMessage,{id:"developerIntegrationNotFound.subtitle.label",defaultMessage:"This integration doesn’t exist."}),onNavigateBack:()=>(0,s.A1)(e),icon:o.Z.eyes({width:98,height:98}),sideContent:null},void 0,null)}},59781:(e,t,r)=>{r.r(t),r.d(t,{default:()=>E});var a=r(77094),i=r.n(a),n=r(67294),o=r(480),l=r(16489),s=r(63123),d=r(59054),u=r(39248),p=r(77420),c=r(44312),g=r(49953),m=r(9844),v=r(70043),f=r(97880),h=r(5366),y=r(50906),b=r(54642),_=r(45016),x=r(43250),M=r(27832),F=r(85227),I=r(3403),w=r(91754),S=r(31278),k=r(29823),R=r(97812),Z=r(73678),C=r(56200),T=r(42402);function E(e){const{botOrIntegrationPointer:t}=e,r=(0,o.O7)(),[{currentUserStore:a}]=(0,l.oR)(M.default),[,,E]=(0,l.oR)(void 0,F.Z),U=(0,l.Kw)(E),P=(0,l.VK)((()=>{if(t&&a){const e=t.table,r=a.getRecordValue(t);if(r){const i=e===m.K2&&"external"===r.type&&a.getRecordValue({table:g.r9,id:t.id});return{botOrIntegrationRecord:{value:r,table:t.table},maybeExternalAuthRecord:i?{table:g.r9,value:i}:void 0}}}}),[a,t]),[{value:B}]=(0,d.r5)((async()=>{if(!a||!P||P.botOrIntegrationRecord.table!==m.K2)return[];const e=P.botOrIntegrationRecord.value.id,t=await b.getIntegrationDomainVerifications(r,{integrationId:e});if("success"===t.type){return t.data.verificationIds.map((e=>a.getRecordValue({table:c.Jd,id:e}))).filter(f.$K)}if("failed"===t.type)throw t.error;return(0,f.t1)(t)}),[r,P,a]);(0,n.useEffect)((()=>{if(!P)return;const{botOrIntegrationRecord:e,maybeExternalAuthRecord:t}=P;E.initializeNewForm(e,t,B||[]),y.trackDeveloperIntegrationsViewVisit(r,{table:e.table})}),[E,r,P,B]);const V=(0,s.V)({value:U.startingRecord});if("rejected"===V.status||!t)return i()(k.Z,{});if("pending"===V.status)return i()(I.Z,{});"resolved"!==V.status&&(0,f.t1)(V);const A=V.value,L=A.value.name,D=A.table===p.cZ?A.value.icon:A.value.info.icon,N={id:A.value.id,table:A.table},q=D?{pointer:N,icon:D}:void 0;return i()(R.Z,{className:x.TFu,title:L,subtitle:i()(h.FormattedMessage,{id:"developerIntegrationView.subtitle.label",defaultMessage:"Review and edit integration information."}),onNavigateBack:()=>(0,_.A1)(r),icon:i()(S.Z,{disabled:!0,icon:q,title:L,isEmptyPage:!1,size:98,isLarge:!0,style:{boxShadow:v.Z.frontDeepShadow},useInvertedColors:!0}),sideContent:i()(C.T,{integrationFormStore:E})},void 0,"published"===U.status&&i()(w.Z,{type:w.$.Red,isMobile:!1},void 0,i()(h.FormattedMessage,{id:"developerIntegrationView.publishedIntegrationWarning",defaultMessage:"As soon as you save changes to this page, your listing on Notion's <integrationgallerylink>Integration Gallery</integrationgallerylink> will be updated.",description:"A warning that appears to developers when they're editing an integration that has already been published in our Integration Gallery.",values:{integrationgallerylink:e=>i()(T.Z,{disableHover:!0,href:(0,u.E)(A.value.id,A.value.name||"")},void 0,e)}})),i()(Z.Z,{integrationFormStore:E}))}},8871:(e,t,r)=>{r.r(t),r.d(t,{default:()=>c});var a=r(77094),i=r.n(a),n=(r(67294),r(16489)),o=r(5366),l=r(43250),s=r(85227),d=r(97812),u=r(73678),p=r(56200);function c(e){const{onClose:t,onSuccess:r}=e,[,,a]=(0,n.oR)(void 0,s.Z);return i()(d.Z,{className:l.Zp2,title:i()(o.FormattedMessage,{id:"developerIntegrationsCreateInternal.title.label",defaultMessage:"Create a new integration"}),subtitle:i()(o.FormattedMessage,{id:"developerIntegrationsCreateInternal.subtitle.label",defaultMessage:"We’ll walk you through how to setup a new integration."}),onNavigateBack:t,sideContent:i()(p.T,{integrationFormStore:a})},void 0,i()(u.Z,{onCreateNew:r,integrationFormStore:a,shouldAutoFocusFirstField:!0}))}},73678:(e,t,r)=>{r.d(t,{Z:()=>Be});var a=r(97464),i=r.n(a),n=r(77094),o=r.n(n),l=r(96486),s=r(67294),d=r(13991),u=r(480),p=r(16489),c=r(8848),g=r(84619),m=r(53397),v=r(74446),f=r(45953),h=r(89101),y=r(21202),b=r(77420),_=r(44312),x=r(9844),M=r(75246),F=r(97880),I=r(82990),w=r(5366),S=r(50906),k=r(54642),R=r(25186),Z=r(45016),C=r(47307),T=r(43250),E=r(81710),U=r(65270),P=r(33665),B=r(38755),V=r(27832),A=r(52507),L=r(14133),D=r(47323),N=r(52275),q=r(97758),z=r(74194),O=r(32163),j=r(91941),W=r(72495),H=r(58032),K=r(24405),$=r(60709),G=r(78140),Y=r(44532);function J(e){const{value:t}=e,[r,a]=s.useState(!1),n=()=>a(!1);return o()(Y.GI,{popupType:Y.GI.PopupType.Popup,alignmentToOrigin:Y.GI.Alignment.Start,placementToOrigin:Y.GI.Placement.Bottom,originGap:2,sameWidthAsOrigin:!0,open:r,onDismiss:n,render:()=>s.createElement(Q,i()({},e,{value:t,onClose:n})),origin:s.createElement(X,i()({},e,{value:t,onClick:()=>a(!0)}))})}function X(e){const{onClick:t,value:r,renderMenuItem:a}=e,i=(0,K.y)((e=>({dropdown:{background:e.whiteButtonBackground,border:`1px solid ${e.outlineButtonBorder}`,borderRadius:3,height:32},expandIcon:{height:12,width:12,fill:e.lightIconColor}})),[]);return s.createElement(s.Fragment,null,a({item:r,focused:!1,onClick:t,style:i.dropdown,right:m.Z.expand(i.expandIcon)}))}function Q(e){const{keyName:t,items:r,value:a,setValue:i,renderMenuItem:n,onClose:l}=e;let d=0;const u=r.map(((e,t)=>(e.id===(null==a?void 0:a.id)&&(d=t),{key:e.id,action:()=>{i(e),l()},render:t=>n({...t,item:e})})));return o()(G.Z,{menuType:$.o.Popup},void 0,o()(O.Z,{type:O.i.Vertical,initialFocus:d,sections:[{key:`form-input-section-${t}`,items:u,render:e=>s.createElement(W.Z,e)}]}))}var ee=r(38381),te=r(97122),re=r(42402);function ae(e){const{onSubmit:t,children:r,submitType:a,capabilitiesHaveChanged:i}=e,n="create-bot"===a||"create-guest-integration"===a||"create-third-party-external-integration"===a;return o()("form",{id:"developer-integration-form",style:{minWidth:200,maxWidth:440,marginLeft:24,display:"flex",flexDirection:"column"},onSubmit:e=>{e.preventDefault(),"create-guest-integration"===a?ee.Z.setState({open:!0,isDestructive:!1,isWarning:!1,title:o()(w.FormattedMessage,{id:"developerIntegrationFormHandler.createIntegration.confirmationModal.title",defaultMessage:"Switch to Public integration?"}),message:o()(w.FormattedMessage,{id:"developerIntegrationFormHandler.createIntegration.confirmationModal.message",defaultMessage:"You‘ll get an OAuth secret and will need to implement OAuth for authorization. See <oauthdocumentationlink>developer docs</oauthdocumentationlink> for more information.",values:{oauthdocumentationlink:e=>o()(re.Z,{href:h._j.developerOAuthDocs},void 0,e)}}),confirmationMessage:o()(w.FormattedMessage,{id:"developerIntegrationFormHandler.createIntegration.confirmationModal.confirm",defaultMessage:"Continue"}),onConfirm:()=>{t()}}):"update-guest-integration"===a&&i?ee.Z.setState({open:!0,isDestructive:!1,isWarning:!0,title:o()(w.FormattedMessage,{id:"developerIntegrationFormHandler.updateIntegration.capabilities.confirmationModal.title",defaultMessage:"Change requested capabilities?"}),message:o()(w.FormattedMessage,{id:"developerIntegrationFormHandler.updateIntegration.capabilities.confirmationModal.message",defaultMessage:"Any existing users of your integration will be required to re-authenticate."}),confirmationMessage:o()(w.FormattedMessage,{id:"developerIntegrationFormHandler.updateIntegration.capabilities.confirmationModal.confirm",defaultMessage:"Change"}),onConfirm:()=>{t()}}):t()}},void 0,r,o()("div",{style:{display:"flex",marginTop:24,flexDirection:"row-reverse",alignItems:"center"}},void 0,o()(te.h,{onClick:()=>{const e=document.querySelector("form#developer-integration-form");if(e){const t=e.ownerDocument.createElement("input");t.style.display="none",t.type="submit",e.appendChild(t).click(),e.removeChild(t)}}},void 0,o()(ie,{isCreate:n})),n&&o()("span",{style:{fontSize:15,color:c.ZP.frontTextLight,marginRight:42}},void 0,o()(w.FormattedMessage,{id:"developerIntegrationFormHandler.create.developerTerms",defaultMessage:"By submitting, you agree to Notion's <developertermslink>Developer Terms</developertermslink>.",values:{developertermslink:e=>o()(re.Z,{href:h._j.developerTerms},void 0,e)}}))))}function ie(e){const{isCreate:t}=e;return t?s.createElement(s.Fragment,null,o()("div",{style:{marginRight:4}},void 0,o()(w.FormattedMessage,{id:"formHandler.submitButton.create.label",defaultMessage:"Submit"})),m.Z.arrowRight({width:14,height:14})):o()(w.FormattedMessage,{id:"formHandler.submitButton.create.update",defaultMessage:"Save changes"})}var ne=r(53471),oe=r(71669),le=r(68785),se=r(63296),de=r(81865);function ue(e){const{value:t,setValue:r,setError:a}=e,i=(0,u.O7)(),[n,l]=s.useState(!1);return s.createElement(s.Fragment,null,t&&o()(de.Z,{url:t,isAuthenticated:!1,stripGoogleIconQuery:!0,width:90,render:(e,t)=>o()("div",{style:{width:90,height:90}},void 0,o()(oe.Z,{src:t,style:{width:90,height:90,objectFit:"cover",borderRadius:3}}))}),o()(se.Z,{isLarge:!0,style:{width:"fit-content",backgroundColor:"white"},onClick:()=>{(0,ne.cR)({environment:i,onStart:()=>l(!0),bucket:"public",onError:e=>{a(e.message),l(!1)},onComplete:e=>{r(e[0]),l(!1)},accept:"image/*"})}},void 0,o()(w.FormattedMessage,{id:"formInputIcon.uploadButton.label",defaultMessage:"Upload image"}),n&&o()(le.Z,{style:{marginLeft:4}})))}function pe(e){const{label:t,subtitle:r,caption:a,error:i,children:n}=e,l=(0,K.y)((()=>({label:{fontSize:15,fontWeight:I.Z.fontWeight.medium,color:c.ZP.frontTextMedium},subtitle:{fontSize:15,color:c.ZP.frontTextLight},caption:{fontSize:15,color:c.ZP.frontTextLight},error:{marginTop:4,fontSize:15,color:c.ZP.frontRed},field:{display:"grid",gridTemplateColumns:"1fr",gap:6,marginBottom:32}})),[]);return o()("label",{style:l.field},void 0,o()("div",{style:l.label},void 0,t),a&&o()("div",{style:l.caption},void 0,a),n,r&&o()("div",{style:l.subtitle},void 0,r),i&&o()("div",{style:l.error},void 0,i))}var ce=r(64369),ge=r(14598);function me(e){const{options:t,value:r,setValue:a}=e;return o()("div",{style:{display:"flex",flexDirection:"column"}},void 0,t.map(((e,i)=>o()(ve,{option:e,value:r,setValue:a,isFirst:0===i,isLast:i===t.length-1},e.key))))}function ve(e){const{option:t,value:r,setValue:a,isFirst:i,isLast:n}=e,l=(0,K.y)((e=>({outliner:{display:"flex",flexDirection:"column",alignItems:"flex-start",height:"auto",padding:18,whiteSpace:"normal",fontSize:15,background:e.whiteButtonBackground,borderTopLeftRadius:i?3:0,borderTopRightRadius:i?3:0,borderBottomLeftRadius:n?3:0,borderBottomRightRadius:n?3:0,...!i&&{borderTop:void 0}}})),[i,n]);return o()(se.Z,{onClick:()=>a(t.key),style:l.outliner},void 0,o()(ge.Z,{title:t.title,isSelected:r===t.key,onClick:()=>{}},t.key),o()(ce.Z,{isMultiline:!0,isSecondaryColor:!0,style:{marginLeft:24,marginTop:-4,fontSize:15}},void 0,t.caption))}var fe=r(91996),he=r(74181),ye=r(95477),be=r(85567),_e=r(719);function xe(e){const{currentValue:t,setNewValue:r,typeaheadTitle:a}=e,n=t||[],[l,d]=s.useState(""),u=()=>d("");return o()(Y.ZP,{popupType:Y.ZP.PopupType.Popup,sameWidthAsOrigin:!0,open:l.length>0,onDismiss:u,origin:o()(_e.Z,{style:{background:c.ZP.white,minHeight:32,fontSize:15},placeholder:"",value:l,onChange:e=>d(e.target.value),tokens:n.map(((e,t)=>o()(be.Z,{format:g.l.Medium,showRemoveButton:!0,isSingle:!1,shouldWrap:!0,value:e,onClickRemove:()=>{r(n.filter((t=>t!==e)))}},`${e}-${t}`))),onRemoveLastToken:()=>{n.length>0&&r(n.slice(0,n.length-1))}}),render:()=>{const e=l.trim(),t=(0,he.ue)(ye.Z.domainBaseUrl,e).map((e=>({key:e,render:t=>s.createElement(N.Z,i()({},t,{title:e})),action:()=>{u(),r([...n,e])}})));return o()(G.Z,{menuType:$.o.Popup},void 0,o()(O.Z,{type:O.i.Vertical,initialFocus:0,sections:[{key:"valid-url-suggestion",items:t,render:e=>s.createElement(W.Z,i()({},e,{title:a}))}]}))}})}function Me(e){const{currentRule:t,onUpdate:r,shouldShowDelete:a,onDelete:i,onError:n}=e,{name:l,regex:d,attributes:u,sampleUrls:p}=t,[g,m]=s.useState(JSON.stringify(u,null,2));return o()("div",{style:{marginBottom:24}},void 0,o()("label",{},void 0,o()("div",{style:{fontSize:15,fontWeight:I.Z.fontWeight.regular,color:c.ZP.frontTextMedium}},void 0,o()(w.FormattedMessage,{id:"developerIntegrationForm.regexRule.name.label",defaultMessage:"Rule Name",description:"Label for the name input of the developer's pattern rule (e.g. github_pull)"})),o()(z.Z,{inputClassName:l,style:{background:c.ZP.white,height:32,fontSize:15},value:l,onChange:e=>{r({...t,name:e.target.value})},right:a&&o()(Fe,{onDelete:i})})),o()("label",{},void 0,o()("div",{style:{fontSize:15,fontWeight:I.Z.fontWeight.regular,color:c.ZP.frontTextMedium}},void 0,o()(w.FormattedMessage,{id:"developerIntegrationForm.sampleUrls.label",defaultMessage:"Sample URLs",description:"Label name for a field for sample URLs the developer wants to test their regexes on."})),o()(xe,{currentValue:p,setNewValue:e=>{r({...t,sampleUrls:e})},setErrorValue:e=>n(e),typeaheadTitle:o()(w.FormattedMessage,{id:"developerIntegrationsForm.urlsInput.typePrompt",defaultMessage:"Type or paste a url…",description:"Prompt that appears as user adds urls to an input field."})})),o()("label",{},void 0,o()("div",{style:{fontSize:15,fontWeight:I.Z.fontWeight.regular,color:c.ZP.frontTextMedium}},void 0,o()(w.FormattedMessage,{id:"developerIntegrationForm.regexRule.pattern.label",defaultMessage:"Pattern",description:"Label for the regex input of the developer's regex pattern rule."})),o()(z.Z,{style:{background:c.ZP.white,fontSize:15},autosize:!0,textarea:!0,value:d,onChange:e=>{r({...t,regex:e.target.value})}})),o()("label",{},void 0,o()("div",{style:{fontSize:15,fontWeight:I.Z.fontWeight.regular,color:c.ZP.frontTextMedium}},void 0,o()(w.FormattedMessage,{id:"developerIntegrationForm.regexRule.attributes.label",defaultMessage:"Attributes",description:"Label for the attributes input of the developer's attribute JSON definition."})),o()(z.Z,{format:z.B.ExtraLarge,style:{backgroundColor:c.ZP.white},inputStyle:{fontSize:14,lineHeight:"18px",height:200,fontFamily:I.Z.baseFontFamily.mono,padding:4},textarea:!0,value:g,onChange:e=>{const a=e.target.value;m(a);const i=(0,fe.Jv)(a);void 0===i?n(o()(w.FormattedMessage,{id:"developerIntegrationForm.jsonEditor.error",defaultMessage:"{value} attributes has invalid JSON.",description:"Error message returned to a developer when their payload is invalid.",values:{value:l}})):r({...t,attributes:i})}})))}function Fe(e){let{onDelete:t}=e;return o()(D.Z,{style:{padding:4,borderRadius:3},onClick:()=>{ee.Z.setState({open:!0,isDestructive:!1,isWarning:!0,title:o()(w.FormattedMessage,{id:"developerIntegrationFormRegexRule.deletionModal.title",defaultMessage:"Are you sure you want to delete this regex pattern rule?",description:"Confirmation modal message developer receives when trying to delete a Link Preview regex pattern rule."}),message:o()(w.FormattedMessage,{id:"developerIntegrationFormRegexRule.deletionModal.message",defaultMessage:"Changes will not be saved until you submit the form.",description:"Help message show in confirmation modal when developer tries to delete a Link Preview regex pattern rule."}),confirmationMessage:o()(w.FormattedMessage,{id:"developerIntegrationFormRegexRule.deletionModal.confirm",defaultMessage:"Delete",description:"Confirmation message shown in modal when developer tries to delete a Link Preview regex pattern rule."}),onConfirm:()=>{t()}})}},void 0,m.Z.trash({width:15,height:15}))}var Ie=r(31278),we=r(76798);const Se=s.forwardRef(((e,t)=>{const{item:r,...a}=e,n=(0,u.O7)(),l=(0,p.VK)((()=>r&&(0,B.getSpaceIcon)(n,r)),[n,r]),d=(0,p.VK)((()=>r&&(0,B.getSpaceName)(n,r)),[n,r]);return s.createElement(N.Z,i()({},a,{ref:t,title:r&&o()(we.Z,{store:r}),icon:r&&o()(Ie.Z,{disabled:!0,icon:l,title:d,isEmptyPage:!1,size:19})}))}));var ke=r(56200);function Re(e){const{fetchSecret:t,secretName:r,onCopy:a,onError:i,confirmationModalProps:n,hasSecretBeenViewed:l}=e,p=(0,u.O7)(),[g,m]=s.useState();return o()(z.Z,{type:g?"text":"password",disabled:!0,style:{fontFamily:I.Z.getCompositeFontFamily(d.SP).mono,color:c.ZP.frontTextMedium},inputStyle:g?{cursor:"text"}:void 0,value:g||" ".repeat(40),right:o()("div",{style:{display:"flex"}},void 0,o()("div",{style:{width:30,marginLeft:-30,height:24,backgroundImage:"linear-gradient(to left, #f7f7f3 20%, rgba(255, 255, 255, 0) 100%)",zIndex:1}}),g?o()(Ce,{secretName:r,onClick:()=>{a&&a(),(0,R.RD)({environment:p,stringValue:g,copiedMessage:R.tq.copiedToClipboard})}}):o()(Ze,{hasSecretBeenViewed:l,onClick:async()=>{const e=async()=>{const e=await t();"secret"in e?m(e.secret):i(e.error.body.message)};n?ee.Z.setState({...n,open:!0,onConfirm:e}):await e()}}))})}function Ze(e){const{onClick:t,hasSecretBeenViewed:r}=e;return o()(D.Z,{onClick:t,style:Te.button},void 0,o()(w.FormattedMessage,r?{id:"formSecretShow.refreshSecret.label",defaultMessage:"Refresh"}:{id:"formSecretShow.showSecret.label",defaultMessage:"Show"}))}function Ce(e){const{onClick:t,secretName:r}=e,[a,n]=s.useState(!1),l=o()(w.FormattedMessage,a?{defaultMessage:"{secretName} copied",id:"formSecretShow.secretCopied.tooltip",description:"Tooltip shown when user copied integration secret to clipboard",values:{secretName:r}}:{defaultMessage:"Copy {secretName}",id:"formSecretShow.copySecret.tooltip",description:"Shortcut for copying a token from an integration management page; 'secretName' will be either 'secret' or 'token'",values:{secretName:r}});return o()(H.Z,{placement:H.Z.Placement.Top,renderTooltip:()=>l,render:e=>s.createElement(D.Z,i()({onClick:e=>{e.preventDefault(),n(!0),setTimeout((()=>{n(!1)}),1500),t()}},e,{style:{...Te.button,color:a?c.ZP.mediumTextColor:c.ZP.blue}}),o()(w.FormattedMessage,a?{id:"formSecretShow.copied.label",defaultMessage:"Copied"}:{id:"formSecretShow.copySecret.label",defaultMessage:"Copy"}))})}const Te={button:{display:"inline-flex",alignItems:"center",fontFamily:I.Z.getCompositeFontFamily(d.SP).sans,borderRadius:3,padding:"0 6px",height:24,color:c.ZP.blue}};var Ee=r(51490),Ue=r(83328),Pe=r(5478);function Be(e){var t;const{integrationFormStore:r,onCreateNew:a,shouldAutoFocusFirstField:i}=e,n=(0,w.useIntl)(),d=(0,u.O7)(),[{currentUserRootStore:c}]=(0,p.oR)(V.default),g=(0,p.Kw)(r),{type:m}=g,v=(0,p.VK)((()=>(0,E.fY)()),[]),f=(0,p.VK)((()=>(0,E.Le)(r.getState().startingRecord)),[r]),[h,b]=s.useReducer(E.x6,E.yb);(0,s.useEffect)((()=>{if(!c)return;(async()=>{const e=await(0,E.hl)({formStoreState:g,userRootStore:c,environment:d});for(const t of(0,F.Yd)(e))b({field:t,value:e[t]})})()}),[g,c,d]);const _=(0,p.VK)((()=>c?c.getAdminSpaceStores():[]),[c]),x=l.debounce((async()=>{const e=(0,E.Xk)({formData:h,formStateType:m});let t;if(e.forEach((e=>{b({field:e,error:o()(w.FormattedMessage,{id:"developerIntegrationsForm.error.missingRequired",defaultMessage:"{ fieldName } is required.",values:{fieldName:v[e].label}})})})),h.template_url.value){const e=(0,P.K2)(h.template_url.value);c&&e&&(t=L.G.createChildStore(c,{table:y.iU,id:e}),await t.load())}const r=(0,E.bd)({formData:h,formStateType:m,templateStore:t});r.forEach((e=>{b({field:e.fieldName,error:e.errorMessages?e.errorMessages.map(((e,t)=>{let{descriptor:r,values:a}=e;return o()("div",{},`validation-error-${t}`,n.formatMessage(r,a))})):o()(w.FormattedMessage,{id:"developerIntegrationsCreateInternal.error.invalidInput",defaultMessage:"{ fieldName } is invalid.",values:{fieldName:v[e.fieldName].label}})})}));if(e.length>0||r.length>0||(0,E.tm)({formData:h,formStateType:m})||!c)return;const i=(0,Z.JJ)({environment:d,formState:g,formData:(0,E.Xr)(h)});if(!i)return void C.showErrorMessage(o()(w.FormattedMessage,{id:"developerIntegrationsForm.error.submission",defaultMessage:"There was an error submitting your integration. Please try again or contact support if the issue persists."}));a&&a(i);const l=document.querySelector(`.${T.rIs}`);l&&l.scrollIntoView({behavior:"smooth"})}),300),M=function(e,t){if(e&&t)for(const[r,a]of(0,F.qP)(t))if(Boolean(e[r])!==a)return!0;return!1}(null===(t=g.startingRecord)||void 0===t?void 0:t.value.capabilities,h.capabilities.value);return o()(ae,{submitType:m,onSubmit:x,capabilitiesHaveChanged:M},void 0,E.cW.map((e=>f[e].supportedBy[m]?o()("div",{style:{marginBottom:24}},e,o()(ke.e,{keyName:e,integrationFormStore:r}),f[e].fields.map((e=>{const{supportedBy:t,label:a,subtitle:n,caption:l}=v[e];if(t[m]){const t=Ve[e];return o()(pe,{label:a,subtitle:n,caption:l,error:h[e].error},e,o()(t,{autoFocus:Boolean(i&&"name"===e),spaces:_,currentValue:h[e].value,setErrorValue:t=>{b({field:e,error:t})},setNewValue:t=>{"submission_type"!==e?"client_secret"!==e&&"token"!==e&&b({value:t,field:e}):r.updateRecordTypeOnSubmission(t)},formStoreState:g}))}return null}))):null)))}const Ve={token:function(e){const{currentValue:t,setErrorValue:r}=e,[{currentUserStore:a}]=(0,p.oR)(V.default),i=(0,u.O7)(),n=(0,p.VK)((()=>{if(!a||!t)return;if(t.value.parent_table!==M.bx)return;const e=L.H2.createChildStore(a,{id:t.value.parent_id,table:t.value.parent_table});return(0,B.getSpaceName)(i,e)}),[a,t,i]);if(!t)return null;return s.createElement(s.Fragment,null,o()(Re,{fetchSecret:async()=>{const e=await k.getBotToken(i,{botId:t.value.id});return"success"===e.type?(S.trackDeveloperIntegrationsViewSecret(i,{table:t.table}),{secret:e.data.token}):{error:e}},secretName:o()(w.FormattedMessage,{id:"developerIntegrationForm.botToken.secretName",defaultMessage:"token"}),onCopy:()=>{S.trackDeveloperIntegrationsCopySecret(i,{table:t.table,from:"developer-integrations-view"})},onError:r}),n&&o()("div",{style:{fontSize:15,color:c.ZP.frontTextLight}},void 0,o()(w.FormattedMessage,{id:"developerIntegrationForm.botToken.subtitle",defaultMessage:"Only works with the <bold>{spaceName}</bold> workspace. To change workspace, <developertermslink>create another integration</developertermslink>.",values:{spaceName:n,bold:e=>o()("b",{},void 0,e),developertermslink:e=>o()(re.Z,{href:h._j.myIntegrations},void 0,e)}})))},client_id:function(e){const{currentValue:t}=e,r=(0,u.O7)(),[a,n]=s.useState(!1);if(!t)return null;const l=o()(w.FormattedMessage,a?{defaultMessage:"ID copied",id:"developerIntegrationsForm.clientIdCopied.tooltip"}:{defaultMessage:"Copy client ID",id:"developerIntegrationsForm.copyClientId.tooltip"});return o()(z.Z,{type:"text",disabled:!0,style:{color:c.ZP.frontTextMedium,fontFamily:I.Z.getCompositeFontFamily(d.SP).mono},value:t.value.id,right:o()("div",{style:{display:"flex"}},void 0,o()("div",{style:{width:30,marginLeft:-30,height:24,backgroundImage:"linear-gradient(to left, #f7f7f3 20%, rgba(255, 255, 255, 0) 100%)",zIndex:1}}),o()(H.Z,{placement:H.Z.Placement.Top,renderTooltip:()=>l,render:e=>s.createElement(D.Z,i()({onClick:e=>{e.preventDefault(),n(!0),setTimeout((()=>{n(!1)}),1500),(0,R.RD)({environment:r,stringValue:t.value.id,copiedMessage:R.tq.copiedLinkToClipboard})}},e,{style:{display:"inline-flex",alignItems:"center",borderRadius:3,padding:"0 6px",height:24,color:a?c.ZP.frontTextMedium:c.ZP.blue,fontFamily:I.Z.getCompositeFontFamily(d.SP).sans}}),o()(w.FormattedMessage,a?{id:"developerIntegrationsForm.copiedId.label",defaultMessage:"Copied"}:{id:"developerIntegrationsForm.copyId.label",defaultMessage:"Copy"}))}))})},client_secret:function(e){const{currentValue:t,setErrorValue:r}=e,a=(0,u.O7)(),[{currentUserStore:i}]=(0,p.oR)(V.default);if(!t||!i)return null;const n=t.value.info.has_viewed_secret,l=(0,L.Kv)(i,{id:t.value.id,table:x.K2});return o()(Re,{fetchSecret:async()=>{const e=await k.getIntegrationSecret(a,{integrationId:t.value.id});return"success"===e.type?((0,Z.bO)({environment:a,integrationStore:l}),S.trackDeveloperIntegrationsViewSecret(a,{table:t.table}),{secret:e.data.secret}):{error:e}},secretName:o()(w.FormattedMessage,{id:"developerIntegrationForm.integrationSecret.secretName",defaultMessage:"secret"}),onCopy:()=>{S.trackDeveloperIntegrationsCopySecret(a,{table:t.table,from:"developer-integrations-view"})},onError:r,hasSecretBeenViewed:n,confirmationModalProps:{isDestructive:!1,isWarning:!1,title:o()(w.FormattedMessage,n?{id:"developerIntegrationForm.clientSecret.confirmationModal.refreshTitle",defaultMessage:"Refresh OAuth client secret?",description:"Confirmation message asking the user if they want to refresh the client secret."}:{id:"developerIntegrationForm.clientSecret.confirmationModal.showTitle",defaultMessage:"Show OAuth client secret?",description:"Confirmation message asking the user if they want to see the client secret."}),message:o()(w.FormattedMessage,n?{id:"developerIntegrationForm.clientSecret.confirmationModal.alreadyViewedMessage",defaultMessage:"You’ve already viewed the client secret. Viewing again will revoke and generate a new one. Make sure you’re storing the secret securely.",description:"Message telling the user about the client secret."}:{id:"developerIntegrationForm.clientSecret.confirmationModal.displayOnceMessage",defaultMessage:"This client secret will only be displayed once and cannot be viewed again. Make sure you’re storing the secret securely.",description:"Message telling the user that the client secret will only show once."}),confirmationMessage:o()(w.FormattedMessage,{id:"developerIntegrationForm.clientSecret.confirmationModal.confirm",defaultMessage:"Continue"})}})},authorization_url:function(e){const{currentValue:t}=e,r=(0,u.O7)(),[a,n]=s.useState(!1);if(!t)return null;const l=o()(w.FormattedMessage,a?{defaultMessage:"URL copied",id:"developerIntegrationsForm.authUrlCopied.tooltip",description:"A message that appears when a user has clicked a button to copy a URL"}:{defaultMessage:"Copy authorization URL",id:"developerIntegrationsForm.authUrlCopy.tooltip",description:"A message that tells the developer that clicking the button will copy a URL to the authorization page"});return o()(z.Z,{type:"text",disabled:!0,style:{color:c.ZP.frontTextMedium,fontFamily:I.Z.getCompositeFontFamily(d.SP).mono},value:t,right:o()("div",{style:{display:"flex"}},void 0,o()("div",{style:{width:30,marginLeft:-30,height:24,backgroundImage:"linear-gradient(to left, #f7f7f3 20%, rgba(255, 255, 255, 0) 100%)",zIndex:1}}),o()(H.Z,{placement:H.Z.Placement.Top,renderTooltip:()=>l,render:e=>s.createElement(D.Z,i()({onClick:e=>{e.preventDefault(),n(!0),setTimeout((()=>{n(!1)}),1500),(0,R.RD)({environment:r,stringValue:t,copiedMessage:R.tq.copiedLinkToClipboard})}},e,{style:{display:"inline-flex",alignItems:"center",borderRadius:3,padding:"0 6px",height:24,color:a?c.ZP.frontTextMedium:c.ZP.blue,fontFamily:I.Z.getCompositeFontFamily(d.SP).sans}}),o()(w.FormattedMessage,a?{id:"developerIntegrationsForm.copiedAuthUrl.label",defaultMessage:"Copied",description:"After clicking this button, the URL will have been copied to the clipboard."}:{id:"developerIntegrationsForm.copyAuthUrl.label",defaultMessage:"Copy",description:"Clicking this button will copy the URL."}))}))})},name:Ae,icon:function(e){const{currentValue:t,setNewValue:r,setErrorValue:a}=e;return o()(ue,{value:t,setValue:r,setError:a})},space:De,developer_space:De,submission_type:function(e){const{currentValue:t,setNewValue:r,formStoreState:a}=e,i=(0,u.O7)(),n="create-bot"===a.type||"create-third-party-external-integration"===a.type,l={internal:{title:o()(w.FormattedMessage,{id:"developerInternalIntegration.integrationType.internal.title",defaultMessage:"Internal integration"}),caption:o()(w.FormattedMessage,{id:"developerInternalIntegration.integrationType.internal.caption",defaultMessage:"Only available for workspaces you’re an admin of. The integration can be installed to those workspaces automatically and does not require review. {createIntegrationCopy}",values:{createIntegrationCopy:n&&o()(w.FormattedMessage,{id:"developerInternalIntegration.integrationType.internal.caption.create",defaultMessage:"Select this option to later upgrade this to a public integration.",description:"If users want to create a public integration, they must select this option to create an internal integration first."})}})},public:{title:o()(w.FormattedMessage,{id:"developerInternalIntegration.integrationType.public.title",defaultMessage:"Public integration"}),caption:o()(w.FormattedMessage,{id:"developerInternalIntegration.integrationType.public.caption",defaultMessage:"Available for any Notion user. May require review and verification for listing in the Integration Gallery."})},unfurling:{title:o()(w.FormattedMessage,{id:"developerInternalIntegration.integrationType.unfurling.title",defaultMessage:"Link preview"}),caption:o()(w.FormattedMessage,{id:"developerInternalIntegration.integrationType.unfurling.caption",defaultMessage:"Available for any Notion user. May require review and verification for listing in the Integration Gallery."})}};if(!t)return null;let s;"update-bot"===a.type||"create-guest-integration"===a.type?s=[{...l.internal,key:"internal"},{...l.public,key:"public"}]:"create-bot"!==a.type&&"create-third-party-external-integration"!==a.type||(s=[{...l.internal,key:"internal"},{...l.unfurling,key:"unfurling"}]);if(!s)return null;return o()(me,{options:s,value:t,setValue:e=>{r(e),S.trackDeveloperIntegrationsToggleType(i,{table:"internal"===e?b.cZ:x.K2})}})},template_url:Ae,redirect_uris:function(e){return s.createElement(xe,i()({},e,{typeaheadTitle:o()(w.FormattedMessage,{id:"developerIntegrationsForm.redirectUri.typePrompt",defaultMessage:"Type a redirect uri…"})}))},website_url:Ae,tagline:Ae,privacy_policy_url:Ae,terms_of_use_url:Ae,email:Ae,capabilities:function(e){const{setNewValue:t}=e,r={...E.fP,...e.currentValue},{enableReadCommentsApi:a,enableWriteCommentsApi:n}=(0,E.qv)();let d;(a||n)&&(d={key:"comment_capabilities",items:[...a?[{key:"read_comment",action:()=>null,render:e=>{const a=()=>{t({...r,read_comment:!r.read_comment})};return s.createElement(N.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_comment.title",defaultMessage:"Read comments",description:"Label for a check box to enable an integration to read comments."}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_comment.caption",defaultMessage:"Read comments on blocks and pages.",description:"Description for a check box to enable an integration to read comments."}),icon:o()(q.Z,{checked:Boolean(r.read_comment),size:16,onClick:a}),onClick:a}))}}]:[],...n?[{key:"insert_comment",action:()=>null,render:e=>{const a=()=>{t({...r,insert_comment:!r.insert_comment})};return s.createElement(N.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.insert_comment.title",defaultMessage:"Insert comments",description:"Label for a check box to enable an integration to insert comments."}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.insert_comment.caption",defaultMessage:"Create comments on blocks and pages.",description:"Description for a check box to enable an integrations to insert comments."}),icon:o()(q.Z,{checked:Boolean(r.insert_comment),size:16,onClick:a}),onClick:a}))}}]:[]],render:e=>s.createElement(W.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.comment_capabilities.title",defaultMessage:"Comment Capabilities",description:"Header for a section where a developer can configure comment access for an integration."})}))});return o()(O.Z,{type:O.i.Vertical,initialFocus:void 0,sections:l.compact([{key:"content_capabilities",items:[{key:"read_content",action:()=>null,render:e=>{const a=()=>{t({...r,read_content:!r.read_content})};return s.createElement(N.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_content.title",defaultMessage:"Read content"}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_content.caption",defaultMessage:"Request to read content."}),icon:o()(q.Z,{checked:Boolean(r.read_content),size:16,onClick:a}),onClick:a}))}},{key:"update_content",action:()=>null,render:e=>{const a=()=>{t({...r,update_content:!r.update_content})};return s.createElement(N.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.update_content.title",defaultMessage:"Update content"}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.update_content.caption",defaultMessage:"Request to update existing content."}),icon:o()(q.Z,{checked:Boolean(r.update_content),size:16,onClick:a}),onClick:a}))}},{key:"insert_content",action:()=>null,render:e=>{const a=()=>{t({...r,insert_content:!r.insert_content})};return s.createElement(N.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.insert_content.title",defaultMessage:"Insert content"}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.insert_content.caption",defaultMessage:"Request to create new content."}),icon:o()(q.Z,{checked:Boolean(r.insert_content),size:16,onClick:a}),onClick:a}))}}],render:e=>s.createElement(W.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.content_capabilities.title",defaultMessage:"Content Capabilities"})}))},d,{key:"user_capabilities",items:[{key:"no_user_capabilities",action:()=>null,render:e=>s.createElement(N.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.no_user_capabilities.title",defaultMessage:"No user information"}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.no_user_capabilities.caption",defaultMessage:"Do not request any user information access."}),icon:o()(Ue.Z,{isSelected:!(r.read_user_without_email||r.read_user_with_email)}),onClick:()=>{t({...r,read_user_without_email:!1,read_user_with_email:!1})}}))},{key:"read_user_without_email",action:()=>null,render:e=>s.createElement(N.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_user_without_email.title",defaultMessage:"Read user information without email addresses"}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_user_without_email.caption",defaultMessage:"Request access to user information, not including email addresses."}),icon:o()(Ue.Z,{isSelected:r.read_user_without_email&&!r.read_user_with_email}),onClick:()=>{t({...r,read_user_without_email:!0,read_user_with_email:!1})}}))},{key:"read_user_with_email",action:()=>null,render:e=>s.createElement(N.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_user_with_email.title",defaultMessage:"Read user information including email addresses"}),caption:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.read_user_with_email.caption",defaultMessage:"Request access to user information, including email addresses."}),icon:o()(Ue.Z,{isSelected:r.read_user_with_email}),onClick:()=>{t({...r,read_user_without_email:!0,read_user_with_email:!0})}}))}],render:e=>s.createElement(W.Z,i()({},e,{title:o()(w.FormattedMessage,{id:"developerIntegrationForm.capabilities.user_capabilities.title",defaultMessage:"User Capabilities"})}))}])})},developer_name:Ae,unfurl_url:Ae,domain:function(e){const{currentValue:t,autoFocus:r,setNewValue:a,formStoreState:i,setErrorValue:n}=e,l=(0,u.O7)(),d=(0,w.useIntl)();if("update-third-party-external-integration"!==i.type&&"update-first-party-external-integration"!==i.type)return null;const{developmentDomain:p,verifiedDomains:m,domainVerifications:h}=t||{developmentDomain:"",verifiedDomains:[],domainVerifications:[]},y=m.map((e=>({domain:e,status:Pe.YF.Success,data:{type:"verified",domain:e}}))),b=Date.now(),x=h.filter(A.AS).sort(((e,t)=>e.createdAt-t.createdAt)).map((e=>({domain:e.domain,status:b>e.expiresAt?Pe.YF.Failure:Pe.YF.Pending,data:{...e,type:b>e.expiresAt?"invalid":"unverified"}}))),M=i.startingRecord.value.id,I=async()=>{const e=await k.getIntegrationDomainVerifications(l,{integrationId:M});if("success"===e.type){const t=f.Ak.create(e.data.recordMap),r=v.mF.fromRecordMapWithRole(t),i=e.data.verificationIds.map((e=>r({table:_.Jd,id:e}))).filter(F.$K).map(A.Hs).filter((e=>"verified"!==e.type));a({developmentDomain:p,verifiedDomains:m,domainVerifications:i})}},S=async e=>{if("verified"!==e.type){const t=await k.deleteDomainVerificationCode(l,{id:e.id});"failed"===t.type&&n(t.error.message),await I()}else(0,Z.QO)({environment:l,integrationId:M,allVerifiedDomains:m,domainToRemove:e.domain})};if("update-third-party-external-integration"===i.type)return o()(Ee.ZP,{domains:[...y,...x],domainVerificationStore:i.domainVerificationStore,verificationType:"integration",verificationTargetId:M,refreshDomains:I,onRemoveDomain:S});return s.createElement(s.Fragment,null,o()("div",{style:Le},void 0,o()(w.FormattedMessage,{id:"developerIntegrationForm.domain.developmentDomain.label",defaultMessage:"Development domain",description:"Label for the development domain input of the user's integration. The domain only used by the integration in the development workspace."})),o()(z.Z,{autoFocus:r,style:{background:c.ZP.white,height:32,fontSize:15},value:p,onChange:e=>a({verifiedDomains:m,domainVerifications:h,developmentDomain:e.target.value})}),o()("div",{style:Le},void 0,o()(w.FormattedMessage,{id:"developerIntegrationForm.domain.verifiedDomains.label",defaultMessage:"Verified domain(s)",description:"Label for domain verification input of the user's integration. Includes modals that will go through adding and verifying a domain and the list of verified domains."})),o()(_e.Z,{placeholder:d.formatMessage({id:"domainVerificationInput.domainInput.placeholder",defaultMessage:"No domains configured",description:"Placeholder input for adding new domains."}),value:"",onChange:()=>{},onRemoveLastToken:()=>{},readOnly:!0,tokens:y.map((e=>{let{domain:t,status:r}=e;return o()(Pe.ZP,{status:r,showRemoveButton:!1,isSingle:!1,format:g.l.Medium,value:t},t)}))}))},url_matching_and_placeholder:function(e){const{currentValue:t,setNewValue:r,setErrorValue:a}=e;return s.createElement(s.Fragment,null,null==t?void 0:t.map(((e,i)=>o()(Me,{currentRule:e,shouldShowDelete:0!==i,onUpdate:e=>{r([...t.slice(0,i),e,...t.slice(i+1)])},onDelete:()=>{0!==i&&r([...t.slice(0,i),...t.slice(i+1)])},onError:a},`regex-rule-${i}`))),o()(j.Z,{style:{display:"flex",alignItems:"center"},isBlue:!0,onClick:e=>{e.preventDefault(),r([...null!=t?t:[],U.VH])}},void 0,m.Z.plus({width:15,height:15}),o()(w.FormattedMessage,{id:"developerIntegrationsForm.regexPatternRulesInput.addMore.label",defaultMessage:"Add another rule",description:"A button in the 'URL matching and placeholder section. Developers can add multiple rules to match pasted URLs to their Link Preview integration."})))},external_oauth_authorize_url:Ae,external_oauth_token_url:Ae,external_client_id:Ae,external_client_secret:function(e){const{autoFocus:t,currentValue:r,setNewValue:a}=e;return o()(z.Z,{type:"password",autoFocus:t,style:{background:c.ZP.white,height:32,fontSize:15},value:r,onChange:e=>a(e.target.value)})},external_oauth_scopes:Ae,external_deletion_url:Ae};function Ae(e){const{autoFocus:t,currentValue:r,setNewValue:a}=e;return o()(z.Z,{autoFocus:t,style:{background:c.ZP.white,height:32,fontSize:15},value:r,onChange:e=>a(e.target.value)})}const Le={marginTop:15,fontSize:15,fontWeight:I.Z.fontWeight.regular,color:c.ZP.frontTextMedium};function De(e){const{spaces:t,currentValue:r,setNewValue:a,setErrorValue:i}=e,[n,l]=s.useState(!1);return(0,s.useEffect)((()=>{n||0!==t.length||(l(!0),i(o()(w.FormattedMessage,{id:"developerIntegrationsForm.spacePicker.missingSpacesError",defaultMessage:"You are not an owner of any workspaces. Please <linktonotion>create a new one</linktonotion> or ask your workspace owner to update your access.",values:{linktonotion:e=>o()(re.Z,{href:(0,P.UY)("guides.joinOrCreateWorkspace")},void 0,e)}})))}),[t,i,n]),o()(J,{keyName:"space",items:t,value:r,setValue:a,renderMenuItem:e=>s.createElement(Se,e)})}},56200:(e,t,r)=>{r.d(t,{e:()=>c,T:()=>g});var a=r(77094),i=r.n(a),n=r(67294),o=r(16489),l=r(8848),s=r(82990),d=r(81710),u=r(91941);function p(e){return`developer-integration-section-header-${e}`}function c(e){const{keyName:t,integrationFormStore:r}=e,a=(0,o.VK)((()=>(0,d.Le)(r.getState().startingRecord)),[r]),{title:n,subtitle:u}=a[t];return i()("div",{id:p(t),style:{fontSize:30,fontWeight:s.Z.fontWeight.bold,marginTop:24,marginBottom:24}},void 0,n,u&&i()("div",{style:{fontSize:15,color:l.ZP.frontTextLight}},void 0,u))}function g(e){const{integrationFormStore:t}=e,{type:r}=(0,o.Kw)(t),a=(0,o.VK)((()=>(0,d.Le)(t.getState().startingRecord)),[t]),c=d.cW.filter((e=>a[e].supportedBy[r])),[g,m]=n.useState(),v=g||c[0];return i()("div",{style:{display:"grid",gridTemplate:"none | auto | auto",marginTop:24,position:"sticky",top:16}},void 0,c.map((e=>i()("div",{},e,i()(u.Z,{style:{fontSize:15,height:28,marginTop:4,color:l.ZP.frontTextLight,width:"100%",...v===e&&{color:l.ZP.frontText,fontWeight:s.Z.fontWeight.medium}},onClick:()=>{const t=document.getElementById(p(e));t&&t.scrollIntoView(),m(e)}},void 0,a[e].title)))))}},81710:(e,t,r)=>{r.d(t,{cW:()=>S,Le:()=>k,fY:()=>R,yb:()=>C,x6:()=>T,hl:()=>U,Xk:()=>P,bd:()=>B,tm:()=>V,fP:()=>A,Xr:()=>N,qv:()=>q});var a=r(77094),i=r.n(a),n=(r(67294),r(16489)),o=r(33728),l=r(21202),s=r(9844),d=r(75246),u=r(97880),p=r(44876),c=r(5366),g=r(45016),m=r(42402),v=r(95477),f=r(10161),h=r(81236),y=r(14133),b=r(71935),_=r(70764),x=r(43348),M=r(91996),F=r(65270),I=r(84210),w=r(33665);const S=["secrets","basic","oauth","organization","external_oauth","unfurling"];function k(e){return{secrets:{title:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.secrets",defaultMessage:"Secrets"}),supportedBy:{"create-bot":!1,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},fields:["token","client_id","client_secret","authorization_url"]},basic:{title:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.basic",defaultMessage:"Basic Information"}),supportedBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},fields:["name","icon","space","developer_space","submission_type","capabilities"]},oauth:{title:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.oauth",defaultMessage:"OAuth Domain & URIs"}),supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},fields:["redirect_uris","developer_name","website_url","tagline","privacy_policy_url","terms_of_use_url","email","template_url"]},organization:{title:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.links",defaultMessage:"Organization Information"}),supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},fields:["developer_name","website_url","tagline","privacy_policy_url","terms_of_use_url","email"]},external_oauth:{title:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.external_oauth",defaultMessage:"External Authorization Setup"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionSubtitle.external_oauth",defaultMessage:"See the <textlink>official IETF spec</textlink> for information on OAuth 2.0.",values:{textlink:e=>i()(m.Z,{href:"https://datatracker.ietf.org/doc/html/rfc6749",external:!0},void 0,e)}}),supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},fields:["external_oauth_authorize_url","external_oauth_token_url","external_client_id","external_client_secret","external_oauth_scopes","external_deletion_url"]},unfurling:{title:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionHeader.unfurling",defaultMessage:"Unfurling Domain & Patterns"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.sectionCaption.unfurling",defaultMessage:"Visit the <previewlab>Link Preview Lab</previewlab> to plan out unfurling previews and responses.",values:{previewlab:t=>{let r="";return(null==e?void 0:e.table)===s.K2&&(r=(0,g.Pk)({table:e.table,id:e.value.id})),i()(m.Z,{href:r,external:!0},void 0,t)}}}),supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},fields:["unfurl_url","domain","url_matching_and_placeholder"]}}}function R(){const e=(0,_.QS)(),t="on"===f.default.getEligibleGroup({experimentId:"oauth_template_duplication",defaultGroup:"control"});return{token:{supportedBy:{"create-bot":!1,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.botToken.label",defaultMessage:"Internal Integration Token"})},client_id:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.integrationClientId.label",defaultMessage:"OAuth client ID"})},client_secret:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.integrationSecret.label",defaultMessage:"OAuth client secret"})},authorization_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.integrationAuthUrl.label",defaultMessage:"Authorization URL",description:"Label in developer integration form for copying a URL that sends users to an authorization page"})},name:{supportedBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.name.label",defaultMessage:"Name"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.name.subtitle",defaultMessage:"Name to identify your integration to users."})},icon:{supportedBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.icon.label",defaultMessage:"Logo"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.icon.subtitle",defaultMessage:"512px x 512px in PNG format is recommended."})},space:{supportedBy:{"create-bot":!0,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!0,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.space.label",defaultMessage:"Associated workspace"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.space.subtitle",defaultMessage:"Select a workspace to install the integration to. You can upgrade the integration to use OAuth later."})},developer_space:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.developerSpace.label",defaultMessage:"Associated workspace"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.developerSpace.subtitle",defaultMessage:"Select a workspace to install the integration to for development. Once approved it will become available to all users."})},submission_type:{supportedBy:{"create-bot":e,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!1,"create-third-party-external-integration":e,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.submissionType.label",defaultMessage:"Integration type"})},redirect_uris:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.redirect_uris.label",defaultMessage:"Redirect URIs"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.redirect_uri.subtitle",defaultMessage:"In the Notion OAuth flow, users will be redirected to this path after they have authenticated with Notion. The path will be appended with the authorization code for access and must have a protocol. It can’t contain URL fragments, relative paths or wildcards, and can’t be a public IP address. It must also be included in the token request."})},website_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.website_url.label",defaultMessage:"Website or homepage"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.website_url.subtitle",defaultMessage:"Used to link to your integration’s website or homepage in your integration page and authentication screens."})},tagline:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.tagline.label",defaultMessage:"Tagline"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.tagline.subtitle",defaultMessage:"A short description of what the integration does."})},privacy_policy_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.privacy_policy_url.label",defaultMessage:"Privacy policy"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.privacy_policy_url.subtitle",defaultMessage:"Used to link to your integration’s privacy policy in your integration page and authentication screens."})},terms_of_use_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.terms_of_use_url.label",defaultMessage:"Terms of use"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.terms_of_use_url.subtitle",defaultMessage:"Used to link to your integration’s terms of use in your integration page and authentication screens."})},template_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":t,"update-guest-integration":t,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.template_url.label",defaultMessage:"URL to Notion template",description:"Label for text field where developers input a URL to a public Notion page"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.template_url.subtitle",defaultMessage:"Optional. URL must be for a public Notion page. Use this field if you'd like to duplicate a template into a user's workspace during OAuth.",description:"Explains what kind of URL is accepted by the 'Notion template' input field, found in the developer portal integration page."})},email:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.email.label",defaultMessage:"Support email"}),subtitle:i()(c.FormattedMessage,{id:"developerIntegrationForm.email.subtitle",defaultMessage:"Used to link to your integration’s support email in your integration page and authentication screens."})},capabilities:{supportedBy:{"create-bot":!0,"update-bot":!0,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.capabilities.label",defaultMessage:"Capabilities"}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.capabilities.caption",defaultMessage:"These requested capabilities will be displayed to users when they authorize your integration. See <inlinetextlink>developer docs</inlinetextlink> for more help.",values:{inlinetextlink:e=>i()(m.Z,{href:"https://developers.notion.com/docs/authorization"},void 0,e)}})},developer_name:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!0,"update-guest-integration":!0,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.developerName.label",defaultMessage:"Company name"}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.developerName.caption",defaultMessage:"The name of your company or organization. You may use your own name if this does not apply."})},unfurl_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.unfurlUrl.label",defaultMessage:"Unfurl Callback URL"}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.unfurlUrl.caption",defaultMessage:"Called with a POST request when an unfurl action occurs and with a DELETE request when unfurl uri preview(s) or mention(s) is deleted."})},domain:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.domain.label",defaultMessage:"Unfurl Url Domain"}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.domainVerification.caption",defaultMessage:"Development and verified domains for URLs to unfurl with this integration. Domains must be verified before publishing to users. See the <textlink>Notion documentation</textlink> for more verification process.",description:"Description of the domain field for integrations and the domain verification process.",values:{textlink:e=>i()(m.Z,{href:"https://developers.notion.com/docs/building-a-link-preview#domain-verification",external:!0},void 0,e)}})},url_matching_and_placeholder:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!0,"update-first-party-external-integration":!0},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.urlMatchingAndPlaceholder.label",defaultMessage:"URL matching and placeholder",description:"Title for 'URL matching and placeholder' input in developer management site."}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.urlMatchingAndPlaceholder.caption",defaultMessage:"When users paste a URL that matches this pattern on your verified domain, they'll have the option to unfurl it as a preview. Any sample URLs are validated against provided patterns.",description:"Caption for 'URL matching and placeholder' input in developer management site."})},external_oauth_authorize_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_authorize_url.label",defaultMessage:"OAuth Authorize URL"}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_authorize_url.caption",defaultMessage:"Used by Notion to initiate user authorization with the integration."})},external_oauth_token_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_token_url.label",defaultMessage:"OAuth Token URL"}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_token_url.caption",defaultMessage:"Called by Notion to retrieve an access token for the unfurl callback URL."})},external_oauth_scopes:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_scopes.label",defaultMessage:"OAuth Scopes (Optional)"}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_oauth_scopes.caption",defaultMessage:"Optional scopes string"})},external_client_id:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_client_id.label",defaultMessage:"OAuth Client ID"})},external_client_secret:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_client_secret.label",defaultMessage:"OAuth Client Secret"})},external_deletion_url:{supportedBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!0,"update-third-party-external-integration":!0,"update-first-party-external-integration":!1},requiredBy:{"create-bot":!1,"update-bot":!1,"create-guest-integration":!1,"update-guest-integration":!1,"create-third-party-external-integration":!1,"update-third-party-external-integration":!1,"update-first-party-external-integration":!1},label:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_deletion_url.label",defaultMessage:"Deleted Token Callback URL (Optional)",description:"Shown in a configuration page for a Notion integration."}),caption:i()(c.FormattedMessage,{id:"developerIntegrationForm.external_deletion_url.caption",defaultMessage:"Called by Notion when a user removes your integration.",description:"Shown in a configuration page for a Notion integration, below the heading 'Deleted Token Callback URL (Optional)'."})}}}const Z={value:void 0,error:void 0},C={token:Z,client_id:Z,client_secret:Z,authorization_url:Z,name:Z,icon:Z,space:Z,developer_space:Z,submission_type:Z,tagline:Z,email:Z,website_url:Z,privacy_policy_url:Z,terms_of_use_url:Z,template_url:Z,redirect_uris:Z,capabilities:Z,developer_name:Z,unfurl_url:Z,domain:Z,url_matching_and_placeholder:Z,external_oauth_authorize_url:Z,external_oauth_token_url:Z,external_client_id:Z,external_client_secret:Z,external_oauth_scopes:Z,external_deletion_url:Z};function T(e,t){return"error"in t?{...e,[t.field]:{...e[t.field],error:t.error}}:{...e,[t.field]:{...e[t.field],...t.value&&{error:void 0},value:t.value}}}async function E(e){const{pageId:t,store:r,environment:a}=e;if(!r||!t)return;const i=y.G.createChildStore(r,{table:l.iU,id:t});return await i.load(),(0,I.Z)({store:i,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=h.Z.getPublicSpaceData(a,i.getSpaceId()))||void 0===e?void 0:e.domain}})}async function U(e){const{userRootStore:t,formStoreState:r,environment:a}=e;if("create-bot"===r.type){return{token:void 0,client_id:void 0,client_secret:void 0,authorization_url:void 0,space:(t?t.getAdminSpaceStores():[])[0],submission_type:r.recordTypeOnSubmission,developer_name:void 0,tagline:void 0,email:void 0,website_url:void 0,privacy_policy_url:void 0,terms_of_use_url:void 0,template_url:void 0,redirect_uris:void 0,capabilities:{read_content:!0,insert_content:!0,update_content:!0,read_comment:!1,insert_comment:!1,read_user_with_email:!0,read_user_without_email:!0},unfurl_url:void 0,domain:void 0,url_matching_and_placeholder:void 0,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("update-bot"===r.type||"create-guest-integration"===r.type){const e=r.startingRecord.value,a=t&&y.H2.createChildStore(t,{id:e.space_id,table:d.bx});return{token:r.startingRecord,client_id:void 0,client_secret:void 0,authorization_url:void 0,name:e.name,icon:e.icon,space:a,developer_space:void 0,submission_type:r.recordTypeOnSubmission,tagline:void 0,email:void 0,website_url:void 0,privacy_policy_url:void 0,terms_of_use_url:void 0,template_url:void 0,redirect_uris:void 0,capabilities:L(e.capabilities),developer_name:void 0,unfurl_url:void 0,domain:void 0,url_matching_and_placeholder:void 0,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("update-guest-integration"===r.type){const e=r.startingRecord.value;return{token:void 0,client_id:r.startingRecord,client_secret:r.startingRecord,authorization_url:(0,b.LH)({baseUrl:(0,b.k2)(v.Z.env,v.Z.isLocalhost),clientId:r.startingRecord.value.id,redirectUri:r.startingRecord.value.redirect_uris[0]}),name:e.name,icon:e.info.icon,space:void 0,developer_space:void 0,submission_type:r.recordTypeOnSubmission,tagline:e.info.tagline,email:e.info.email,website_url:e.info.website_url,privacy_policy_url:e.info.privacy_policy_url,terms_of_use_url:e.info.terms_of_use_url,template_url:await E({pageId:e.info.template_page_id,store:t,environment:a}),redirect_uris:e.redirect_uris,capabilities:L(e.capabilities),developer_name:e.info.developer_name,unfurl_url:void 0,domain:void 0,url_matching_and_placeholder:void 0,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("create-third-party-external-integration"===r.type){return{token:void 0,client_id:void 0,client_secret:void 0,authorization_url:void 0,space:void 0,developer_space:(t?t.getAdminSpaceStores():[])[0],submission_type:r.recordTypeOnSubmission,tagline:void 0,email:void 0,website_url:void 0,privacy_policy_url:void 0,terms_of_use_url:void 0,template_url:void 0,redirect_uris:void 0,capabilities:void 0,developer_name:void 0,unfurl_url:void 0,domain:{developmentDomain:F.nZ,verifiedDomains:[],domainVerifications:[]},url_matching_and_placeholder:[F.VH],external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}if("update-third-party-external-integration"===r.type){var i,n;const e=r.startingRecord.value,a=null===(i=r.startingAuthRecord)||void 0===i?void 0:i.value,o=r.domainVerifications,l=e.info.developer_space_id,s=l&&t?y.H2.createChildStore(t,{id:l,table:d.bx}):void 0,c=e.info.original_url_patterns||[],g={developmentDomain:(null===(n=e.info.development_url_domains)||void 0===n?void 0:n[0])||"",verifiedDomains:e.info.original_url_domains||[],domainVerifications:o},m=c.map((t=>{var r,a,i;if(!0!==(null===(r=t.additional_types)||void 0===r?void 0:r.collection))return{name:(0,x.R)({patternName:t.name,integrationId:e.id}),regex:t.regex,attributes:(null!==(a=null==t?void 0:t.attributes)&&void 0!==a?a:[]).map(p.Ah),sampleUrls:null!==(i=null==t?void 0:t.sample_urls)&&void 0!==i?i:[]}})).filter(u.$K);return{token:void 0,client_id:r.startingRecord,client_secret:r.startingRecord,authorization_url:void 0,name:e.name,icon:e.info.icon,space:void 0,developer_space:s,submission_type:r.recordTypeOnSubmission,tagline:e.info.tagline,email:e.info.email,website_url:e.info.website_url,privacy_policy_url:e.info.privacy_policy_url,terms_of_use_url:e.info.terms_of_use_url,template_url:void 0,redirect_uris:e.redirect_uris,capabilities:void 0,developer_name:e.info.developer_name,domain:g,url_matching_and_placeholder:m,unfurl_url:e.info.unfurl_url,external_oauth_authorize_url:null==a?void 0:a.oauth_authorize_url,external_oauth_token_url:null==a?void 0:a.oauth_token_url,external_client_id:null==a?void 0:a.client_id,external_client_secret:null==a?void 0:a.client_secret,external_oauth_scopes:null==a?void 0:a.scopes,external_deletion_url:null==a?void 0:a.deletion_url}}if("update-first-party-external-integration"===r.type){var o,l;const e=r.startingRecord.value,a=e.info.developer_space_id,i=a&&t?y.H2.createChildStore(t,{id:a,table:d.bx}):void 0,n=e.info.original_url_patterns||[],s={developmentDomain:(null===(o=e.info.development_url_domains)||void 0===o?void 0:o[0])||"",verifiedDomains:null!==(l=e.info.original_url_domains)&&void 0!==l?l:[],domainVerifications:[]},c=n.map((t=>{var r,a,i;if(!0!==(null===(r=t.additional_types)||void 0===r?void 0:r.collection))return{name:(0,x.R)({patternName:t.name,integrationId:e.id}),regex:t.regex,attributes:(null!==(a=null==t?void 0:t.attributes)&&void 0!==a?a:[]).map(p.Ah),sampleUrls:null!==(i=null==t?void 0:t.sample_urls)&&void 0!==i?i:[]}})).filter(u.$K);return{token:void 0,client_id:r.startingRecord,client_secret:r.startingRecord,authorization_url:void 0,name:e.name,icon:e.info.icon,space:void 0,developer_space:i,submission_type:r.recordTypeOnSubmission,tagline:e.info.tagline,email:e.info.email,website_url:e.info.website_url,privacy_policy_url:e.info.privacy_policy_url,terms_of_use_url:e.info.terms_of_use_url,template_url:void 0,redirect_uris:e.redirect_uris,capabilities:void 0,developer_name:e.info.developer_name,domain:s,url_matching_and_placeholder:c,unfurl_url:e.info.unfurl_url,external_oauth_authorize_url:void 0,external_oauth_token_url:void 0,external_client_id:void 0,external_client_secret:void 0,external_oauth_scopes:void 0,external_deletion_url:void 0}}(0,u.t1)(r)}function P(e){const{formData:t,formStateType:r}=e,a=[],i=R();for(const n of(0,u.Yd)(i)){const e=t[n].value;i[n].requiredBy[r]&&!e&&a.push(n)}return a}function B(e){const{formData:t,formStateType:r,templateStore:a}=e,i=[];for(const o of(0,u.Yd)(t)){const e=t[o].value,l=R()[o].supportedBy[r],s=M.tV[o];if(l&&e&&s){const r=s({value:e,formData:t,templateStore:a});var n;if(!r.validated)i.push({fieldName:o,errorMessages:null===(n=r.errorMessages)||void 0===n?void 0:n.map((e=>{let{descriptor:t,values:r}=e;return{descriptor:t,values:null!=r?r:{}}}))})}}return i}function V(e){const{formData:t,formStateType:r}=e;return(0,u.Yd)(t).some((e=>R()[e].supportedBy[r]&&t[e].error))}const A={read_content:!1,update_content:!1,insert_content:!1,read_user_without_email:!1,read_user_with_email:!1,read_comment:!1,insert_comment:!1};function L(e){const t={...A};return e&&Object.entries(e).forEach((e=>{let[r,a]=e;a&&(t[r]=!0)})),t}function D(e){if(!e)return;const t={};return Object.entries(e).forEach((e=>{let[r,a]=e;a&&(t[r]=!0)})),t}function N(e){var t,r;return{token:e.token.value,client_id:e.client_id.value,client_secret:e.client_secret.value,authorization_url:e.authorization_url.value,name:e.name.value,icon:e.icon.value,space:e.space.value,submission_type:e.submission_type.value,redirect_uris:(e.redirect_uris.value||[]).map((e=>M.FR(e))),website_url:M.FR(e.website_url.value),tagline:e.tagline.value,privacy_policy_url:M.FR(e.privacy_policy_url.value),terms_of_use_url:M.FR(e.terms_of_use_url.value),template_page_id:null!==(t=(0,w.K2)(null!==(r=e.template_url.value)&&void 0!==r?r:""))&&void 0!==t?t:null,email:o.H3(e.email.value),capabilities:D(e.capabilities.value),developer_name:e.developer_name.value,developer_space:e.developer_space.value,unfurl_url:e.unfurl_url.value,domain:e.domain.value,url_matching_and_placeholder:e.url_matching_and_placeholder.value,external_oauth_authorize_url:M.FR(e.external_oauth_authorize_url.value),external_oauth_token_url:M.FR(e.external_oauth_token_url.value),external_client_id:e.external_client_id.value,external_client_secret:e.external_client_secret.value,external_oauth_scopes:e.external_oauth_scopes.value,external_deletion_url:M.FR(e.external_deletion_url.value)}}function q(){return{enableReadCommentsApi:"on"===(0,n.VK)((()=>f.default.getEligibleGroup({experimentId:"enable_read_comments_public_api",defaultGroup:"control"})),[]),enableWriteCommentsApi:"on"===(0,n.VK)((()=>f.default.getEligibleGroup({experimentId:"enable_write_comments_public_api",defaultGroup:"control"})),[])}}},91996:(e,t,r)=>{r.d(t,{Jv:()=>h,FR:()=>M,tV:()=>w});var a=r(33728),i=r(20270),n=r(74181),o=r(89602),l=r(97880),s=r(44876),d=r(64002),u=r(63143),p=r(36054),c=r(5366),g=r(95477),m=r(67669),v=r(33665);const f=(0,c.defineMessages)({capabilityErrorMessage:{id:"developerIntegrationsCreate.error.capabilities.invalidContent2",defaultMessage:"At least one capability must be requested.",description:"Error message that a developer should request at least one capability for their integration"},regexPatternErrorMessage:{id:"developerIntegrationFormValidator.urlMatchingAndPlaceholder.regex.error",defaultMessage:"{value} regex pattern is invalid.",description:"Value will be the developer named link preview pattern. (e.g. github_pull_request pattern is invalid."},regexAttributesErrorMessage:{id:"developerIntegrationFormValidator.urlMatchingAndPlaceholder.attributes.error",defaultMessage:"{value} attributes JSON does not match request schema.",description:"Value will be the developer named link preview pattern. (e.g. github_pull_request attributes JSON does not match request schema."},sampleUrlMissingDomain:{id:"developerIntegrationFormValidator.sampleUrls.sampleUrlMissingDomain.error",defaultMessage:'URL "{value}" is missing a domain.',description:"Value will be a developer configured URL. Error appears if URL is misconfigured."},sampleUrlDoesNotMatchProvidedDomain:{id:"developerIntegrationFormValidator.sampleUrls.sampleUrlDoesNotMatchProvidedDomain.error",defaultMessage:'URL "{value}" does not match a provided domain.',description:"Value will be a developer configured URL. Error appears if URL doesn't match the configured domain (e.g. google.com)"},sampleUrlDoesNotMatchProvidedRegexes:{id:"developerIntegrationFormValidator.sampleUrls.sampleUrlDoesNotMatchProvidedRegexes.error",defaultMessage:'URL "{value}" does not match a provided regex pattern.',description:"Value will be a developer configured URL. Error appears if URL doesn't match a configured regex pattern."},templateUrlIsNotNotionPage:{id:"developerIntegrationFormValidator.templateUrl.templateUrlIsNotNotionPage.error",defaultMessage:"URL must direct to a public Notion template.",description:"Error appears if URL directs to anywhere that's not a public Notion template."},templateUrlCannotBeDuplicated:{id:"developerIntegrationFormValidator.templateUrl.templateUrlCannotBeDuplicated.error",defaultMessage:"Linked template must be public.",description:"Error appears if URL directs to Notion page that can't be duplicated."}});function h(e){let t;try{t=JSON.parse(e)}catch(r){t=void 0}return t}function y(e){const{value:t}=e,r=d.yn(t);if(!r)return{validated:!1};return d.Qc(r).hostname?{validated:!0}:{validated:!1}}function b(e){try{return new RegExp(e),{validated:!0}}catch{return{validated:!1}}}function _(e){if((0,p.Gu)(o.$1,e))return{validated:!1};for(const t of e){const e=(0,s.GY)(t);if(!(0,i.nj)(e))return{validated:!1}}return{validated:!0}}function x(e){const{domains:t,regex:r,urls:a}=e;if(0===a.length)return[];const i=[];for(const n of a){const e=(0,s.XR)({url:n,domains:t,regex:new RegExp(r)});"invalid_url"===e.type?i.push({descriptor:f.sampleUrlMissingDomain,value:n}):"url_does_not_match_domain"===e.type?i.push({descriptor:f.sampleUrlDoesNotMatchProvidedDomain,value:n}):"url_does_not_match_regex"===e.type?i.push({descriptor:f.sampleUrlDoesNotMatchProvidedRegexes,value:n}):"success"===e.type||(0,l.t1)(e)}return i}function M(e){const t=d.yn(e);if(!t||!e)return;const r=t[t.length-1],a=e[e.length-1];return"/"===r&&"/"!==a?t.slice(0,t.length-1):t}const F={insert_comment:!0,insert_content:!0,read_comment:!0,read_content:!0,update_content:!0,read_user_with_email:!1,read_user_without_email:!1},I=(0,l.Yd)(F).filter((e=>F[e]));const w={email:function(e){const{value:t}=e,r=a.H3(t);return r?{validated:a.oH(r).valueOf()}:{validated:!1}},redirect_uris:function(e){const{value:t}=e;return{validated:t.every((e=>(0,n.mb)(g.Z.domainBaseUrl,e)))}},website_url:y,privacy_policy_url:y,terms_of_use_url:y,template_url:function(e){const{value:t,templateStore:r}=e;return d.yn(t)?(0,v.K2)(t)?r&&(0,m.Oc)(r)?{validated:!0}:{validated:!1,errorMessages:[{descriptor:f.templateUrlCannotBeDuplicated}]}:{validated:!1,errorMessages:[{descriptor:f.templateUrlIsNotNotionPage}]}:{validated:!1}},capabilities:function(e){const{value:t}=e;return I.some((e=>t[e]))?{validated:!0}:{validated:!1,errorMessages:[{descriptor:f.capabilityErrorMessage}]}},unfurl_url:y,url_matching_and_placeholder:function(e){const{value:t,formData:r}=e,a=[];for(const o of t){if(b(o.regex).validated){var i;const e=x({domains:(n=null===(i=r.domain)||void 0===i?void 0:i.value,n?(0,u.jj)([...n.developmentDomain&&[n.developmentDomain],...n.domainVerifications.map((e=>{let{domain:t}=e;return t})),...n.verifiedDomains]):[]),regex:o.regex,urls:o.sampleUrls});a.push(...e)}else a.push({descriptor:f.regexPatternErrorMessage,value:o.name});_(o.attributes).validated||a.push({descriptor:f.regexAttributesErrorMessage,value:o.name})}var n;return a.length>0?{validated:!1,errorMessages:a.map((e=>{let{descriptor:t,value:r}=e;return{descriptor:t,values:{value:r}}}))}:{validated:!0}},external_oauth_authorize_url:y,external_oauth_token_url:y,external_deletion_url:y}},65270:(e,t,r)=>{r.d(t,{TG:()=>m,rn:()=>v,C:()=>f,Az:()=>h,nZ:()=>y,e_:()=>b,P4:()=>_,VH:()=>x,SV:()=>M,VR:()=>w,Hx:()=>S});r(99244);var a=r(26263),i=r(41432),n=r(20270),o=r(4615),l=r(21202),s=r(19889),d=r(70203),u=r(97880),p=r(44876),c=r(63143),g=r(14133);function m(e){return(0,c.jj)(e.flatMap((e=>{if("relation"===e.type)return e.relation.uri})).filter(u.$K))}function v(e){const{environment:t,integration:r,rootUrl:u,rootAttributes:c,relatedUrisToAttributes:m}=e,v=(0,o.ZP)(),f=t.currentUser.id,h=new a.Z,y=[],b={};for(const[a,i]of Object.entries(m)){const e=(0,o.ZP)();y.push({id:e,uri:a,attributes:i}),b[a]=e}const _=[{id:"rootInstanceId",original_url:u,attributes:c,related_external_object_uris_to_instance_ids:b},...y].map((e=>{const t=[];for(const r of e.attributes){const e=(0,p.GY)(r);(0,n.nj)(e)&&t.push(e)}return{...e,attributes:t}}));if("success"!==(0,p.ny)({url:u,integrations:[r],currentSpaceId:v}).type)return{error:"Sample URL does not match provided integration regex."};const x={table:l.iU,id:(0,o.ZP)(),spaceId:v};let M;for(const a of _){const e={table:l.iU,id:a.id,spaceId:v},t={...a,domain:"test"},r={id:a.id,type:i.ZP.externalObjectInstance,version:0,created_at:0,created_by_table:s.KJ,created_by_id:(0,o.ZP)(),last_edited_time:0,last_edited_by_table:s.KJ,last_edited_by_id:(0,o.ZP)(),parent_table:l.iU,parent_id:(0,o.ZP)(),space_id:v,alive:!0,domain:"",format:t};if(h.setRecord({pointer:e,userId:f},{role:"editor",value:r}),a===_[0]){const a={...r,format:{...t,attributes:void 0}};h.setRecord({pointer:x,userId:f},{role:"editor",value:a}),M=e}}if(!M)return{error:"Root external object was not defined."};const F=new g.G(t,x,{inMemoryRecordCache:h}),I=new g.G(t,M,{inMemoryRecordCache:h}),w={table:l.iU,id:(0,o.ZP)(),spaceId:v},S=new g.G(t,w,{inMemoryRecordCache:h}),k={id:w.id,type:"text",version:0,space_id:v,parent_id:(0,o.ZP)(),parent_table:l.iU,alive:!0,properties:{title:[(0,d.YC)((0,d.x3)(x.id))]}};h.setRecord({pointer:w,userId:f},{role:"editor",value:k});const R={table:l.iU,id:(0,o.ZP)(),spaceId:v},Z=new g.G(t,R,{inMemoryRecordCache:h}),C={id:R.id,type:"text",version:0,space_id:v,parent_id:(0,o.ZP)(),parent_table:l.iU,alive:!0,properties:{title:[(0,d.YC)((0,d.x3)(_[0].id))]}};return h.setRecord({pointer:R,userId:f},{role:"editor",value:C}),{emptyInstanceBlockStore:F,previewBlockStore:I,emptyInlineBlockStore:S,inlineBlockStore:Z}}const f=(0,o.ZP)(),h="https://acme.com/items/23487",y="acme.com",b="^(?<site>https\\:\\/\\/acme\\.com)\\/items\\/(?<itemNo>\\d+)$",_=[{id:"title",name:"Title",type:"inline",inline:{title:{value:"Acme Item #$<itemNo>",section:"title"}}},{id:"itemId",name:"Item Id",type:"inline",inline:{plain_text:{value:"#$<itemNo>",section:"identifier"}}},{id:"site",name:"Site",type:"inline",inline:{plain_text:{value:"$<site>",section:"secondary"}}}],x={name:"item",regex:b,attributes:_,sampleUrls:[h]},M=[{id:"title",name:"Title",type:"inline",inline:{title:{value:"Feature Request: Link Previews",section:"title"}}},{id:"state",name:"State",type:"relation",relation:{uri:"acme:item_state/open",mention:{section:"primary"}}},{id:"itemId",name:"Item Id",type:"inline",inline:{plain_text:{value:"#23487",section:"identifier"}}},{id:"itemIcon",name:"Item Icon",type:"inline",inline:{color:{value:{r:247,g:247,b:42},section:"entity"}}},{id:"user",name:"User",type:"relation",relation:{uri:"https://acme.com/fig-ment",extension:[{id:"title",section:"secondary"},{id:"avatar_url",section:"avatar"}]}},{id:"description",name:"Description",type:"inline",inline:{plain_text:{value:"Would love to be able to preview some Acme resources in Notion!\n Maybe an open item?",section:"body"}}},{id:"updated_at",name:"Updated At",type:"inline",inline:{datetime:{value:"2022-01-11T19:53:18.829Z",section:"secondary"}}},{id:"label",name:"Label",type:"inline",inline:{enum:{value:"🔨 Ready to Build",color:{r:100,g:100,b:100},section:"primary"}}}],F={uri:"https://acme.com/fig-ment",attributes:[{id:"title",name:"User Name",type:"inline",inline:{title:{value:"fig"}}},{id:"avatar_url",name:"Avatar URL",type:"embed",embed:{src_url:"https://avatars.githubusercontent.com/u/93556354?s=88&u=4967f0be0900684b6963a953ca7fe0ff2268746f&v=4",image:{}}}]},I={uri:"acme:item_state/open",attributes:[{id:"title",name:"Title",type:"inline",inline:{title:{value:"Open",section:"title"}}},{id:"icon",name:"Icon",type:"embed",embed:{src_url:"/images/external_integrations/acme-icon.png",image:{section:"avatar"}}},{id:"color",name:"Color",type:"inline",inline:{color:{value:{r:235,g:64,b:52},section:"background"}}}]};function w(){const e=[F,I],t=m(M),r={};for(const a of t){const t=e.find((e=>e.uri===a));t&&(r[a]=t.attributes)}return r}function S(e){const{domain:t,regex:r,currentIntegration:a}=e,i={...a.info,original_url_domains:[t],original_url_patterns:[{name:"acme-issue",regex:r,attributes:e.attributes.map((e=>{const t=(0,p.GY)(e);if((0,n.nj)(t))return t})).filter(u.$K)}]};return{...a,info:i}}},85227:(e,t,r)=>{r.d(t,{Z:()=>p});var a=r(49085),i=r(77420),n=r(9844),o=r(5500),l=r(97880),s=r(95477),d=r(52507);class u extends a.Z{getInitialState(){return{type:"create-bot",startingRecord:void 0,recordTypeOnSubmission:"internal",status:"unpublished"}}updateRecordTypeOnSubmission(e){"create-bot"===this.state.type?"unfurling"===e&&this.setState({type:"create-third-party-external-integration",startingRecord:this.state.startingRecord,startingAuthRecord:void 0,recordTypeOnSubmission:e,status:"unpublished"}):"update-bot"===this.state.type?"public"===e&&this.setState({type:"create-guest-integration",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,status:"unpublished"}):"create-guest-integration"===this.state.type?"internal"===e&&this.setState({type:"update-bot",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,status:"unpublished"}):"update-guest-integration"===this.state.type||("create-third-party-external-integration"===this.state.type?"internal"===e&&this.setState({type:"create-bot",startingRecord:this.state.startingRecord,recordTypeOnSubmission:e,status:"unpublished"}):"update-third-party-external-integration"===this.state.type||"update-first-party-external-integration"===this.state.type||(0,l.t1)(this.state))}initializeNewForm(e,t,r){if(e.table===i.cZ)this.setState({type:"update-bot",startingRecord:e,recordTypeOnSubmission:"internal",status:"unpublished"});else if(e.table===n.K2)if("external"===e.value.type)if((0,o.BP)({integrationId:e.value.id,env:s.Z.env}))this.setState({type:"update-first-party-external-integration",startingRecord:{table:e.table,value:e.value},recordTypeOnSubmission:"unfurling",status:e.value.status});else{if(!t)return;const a=r.map((e=>({type:e.verified_at?"verified":"unverified",id:e.id,domain:e.domain,verificationCode:e.verification_code,createdAt:e.created_at,expiresAt:e.expires_at,alive:e.alive})));this.setState({type:"update-third-party-external-integration",startingRecord:{table:e.table,value:e.value},startingAuthRecord:t,recordTypeOnSubmission:"unfurling",status:e.value.status,domainVerifications:a,domainVerificationStore:"update-third-party-external-integration"===this.state.type?this.state.domainVerificationStore:new d.ZP})}else this.setState({type:"update-guest-integration",startingRecord:{table:e.table,value:e.value},recordTypeOnSubmission:"public",status:e.value.status});else(0,l.t1)(e)}}const p=u},89602:(e,t,r)=>{r.d(t,{$1:()=>Z});var a=r(14710),i=r(74487);const n=i.object({required:{r:i.lte(i.gte(i.integer(),0),255),g:i.lte(i.gte(i.integer(),0),255),b:i.lte(i.gte(i.integer(),0),255)},optional:{}}),o=i.object({required:{value:i.union([i.string(),i.nonEmpty(i.array(i.string()))])},optional:{section:i.literals(a.kE.avatar,a.kE.identifier,a.kE.primary,a.kE.secondary,a.kE.body)}}),l=i.object({required:{value:i.union([i.boolean(),i.nonEmpty(i.array(i.boolean()))])},optional:{}}),s=i.object({required:{value:i.union([i.number(),i.nonEmpty(i.array(i.number()))])},optional:{}}),d=i.object({required:{value:i.union([i.string(),i.nonEmpty(i.array(i.string()))])},optional:{color:n,section:i.literals(a.kE.primary)}}),u=i.object({required:{value:i.union([i.string(),i.tuple([i.string()])])},optional:{color:n,section:i.literal(a.kE.title)}}),p=i.object({required:{value:i.union([n,i.nonEmpty(i.array(n))])},optional:{section:i.literals(a.kE.entity,a.kE.background)}}),c=i.object({required:{value:i.union([i.dateString(),i.nonEmpty(i.array(i.dateString()))])},optional:{section:i.literals(a.kE.primary,a.kE.secondary)}}),g=i.object({required:{value:i.union([i.dateString(),i.nonEmpty(i.array(i.dateString()))])},optional:{section:i.literals(a.kE.primary,a.kE.secondary)}}),m=i.object({required:{value:i.union([i.dateString(),i.tuple([i.dateString()])])},optional:{section:i.literals(a.kE.primary,a.kE.secondary)}}),v=i.object({required:{value:i.union([i.dateString(),i.tuple([i.dateString()])])},optional:{section:i.literals(a.kE.primary,a.kE.secondary)}}),f=i.union([i.object({required:{plain_text:o},optional:{type:i.literal("plain_text")}}),i.object({required:{boolean:l},optional:{type:i.literal("boolean")}}),i.object({required:{number:s},optional:{type:i.literal("number")}}),i.object({required:{enum:d},optional:{type:i.literal("enum")}}),i.object({required:{title:u},optional:{type:i.literal("title")}}),i.object({required:{color:p},optional:{type:i.literal("color")}}),i.object({required:{date:c},optional:{type:i.literal("date")}}),i.object({required:{datetime:g},optional:{type:i.literal("datetime")}}),i.object({required:{created_datetime:m},optional:{type:i.literal("created_datetime")}}),i.object({required:{last_edited_datetime:v},optional:{type:i.literal("last_edited_datetime")}})]),h=i.object({required:{},optional:{section:i.literal(a.kE.embed)}}),y=i.object({required:{},optional:{section:i.literal(a.kE.embed)}}),b=i.object({required:{},optional:{section:i.literal(a.kE.embed)}}),_=i.object({required:{},optional:{section:i.literal(a.kE.embed)}}),x=i.object({required:{},optional:{format:i.nullable(i.literals("icon")),section:i.literals(a.kE.avatar,a.kE.entity,a.kE.embed)}}),M=i.intersection([i.object({required:{src_url:i.union([i.string(),i.nonEmpty(i.array(i.string()))])},optional:{}}),i.union([i.object({required:{html:h},optional:{type:i.literal("html")}}),i.object({required:{pdf:y},optional:{type:i.literal("pdf")}}),i.object({required:{audio:b},optional:{type:i.literal("audio")}}),i.object({required:{video:_},optional:{type:i.literal("video")}}),i.object({required:{image:x},optional:{type:i.literal("image")}})])]),F=i.union([i.string(),i.nonEmpty(i.array(i.string()))]),I=i.object({required:{uri:F},optional:{type:i.literal("mention"),mention:i.object({required:{},optional:{section:i.literal(a.kE.primary)}}),extension:i.isNull()}}),w=i.object({required:{uri:F},optional:{type:i.literal("extension"),extension:i.nonEmpty(i.array(i.object({required:{id:i.string()},optional:{section:i.literals(a.kE.avatar,a.kE.embed,a.kE.primary,a.kE.secondary)}}))),mention:i.isNull()}}),S=i.union([I,w]),k=i.object({required:{uri:F},optional:{}}),R=i.intersection([i.object({required:{id:i.string(),name:i.string()},optional:{}}),i.union([i.object({required:{inline:f},optional:{type:i.literal("inline")}}),i.object({required:{embed:M},optional:{type:i.literal("embed")}}),i.object({required:{relation:S},optional:{type:i.literal("relation")}}),i.object({required:{people:k},optional:{type:i.literal("people")}})])]),Z=i.array(R)}}]);